#!/usr/bin/env python
# coding: utf-8

#  <div style="border-radius: 15px; box-shadow: 2px 2px 4px; border: 1px solid; background:#bdc3c7; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <h7 style="color:black; margin-bottom:20px"> –í–∞–ª–µ–Ω—Ç–∏–Ω–∞, –ø—Ä–∏–≤–µ—Ç! 
# 
# –ú–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∑–∞–º–µ—á–∞–Ω–∏—è –¥–∞–ª–µ–µ –ø–æ —Ç–µ–∫—Å—Ç—É –ø–æ–º–µ—á–µ–Ω—ã —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏:
# 
# ---
# <div class="alert alert-block alert-danger">
# ‚ÅâÔ∏è : –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å.
# </div>
# 
# <div class="alert alert-block alert-warning">
# ‚úèÔ∏è : –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è\—Å–æ–≤–µ—Ç –Ω–∞ –±—É–¥—É—â–µ–µ.
# </div>
# 
# <div class="alert alert-block alert-success">
# ‚úîÔ∏è : –ö–æ–≥–¥–∞ –≤—Å—ë —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
# </div>
# 
# ---
# 
# –•–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π —è–≤–ª—è–µ—Ç—Å—è –æ—Å—Ç–∞–≤–ª—è—Ç—å —Å–≤–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∑–∞–º–µ—á–∞–Ω–∏–π –∏–ª–∏ –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤, —Ä–∞–∑—ä—è—Å–Ω–µ–Ω–∏–π. –î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –º–Ω–µ –±—ã–ª–æ –ª–µ–≥—á–µ –∏—Ö –Ω–∞–π—Ç–∏, —Ç–æ –≤—ã–¥–µ–ª—è–π, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å –ø–æ–º–æ—â—å—é —Ü–≤–µ—Ç–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤–æ—Ç —Ç–∞–∫:
# 
# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –í–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–µ–∑–∞–º–µ—á–µ–Ω–Ω—ã–º
# 
# </div>
# 
# ---
# 
# **–í —Ä–∞–º–∫–∞—Ö —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–ø—Ä–∏–Ω—Ç–∞ —É –≤–∞—Å –µ—Å—Ç—å –ª–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –ø—Ä–æ–≤–µ—Ä–æ–∫. –Ø –±—É–¥—É –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏—Ö –æ—Ç–º–µ—á–∞—Ç—å –≤ –∏—Ç–æ–≥–æ–≤–æ–º —Ä–µ–≤—å—é:**
# 
# <div class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid ">
# 
# **`[1/6]`**
# 
# –ò—Ç–æ–≥ —Ä–µ–≤—å—é - ...
# 
# </div>
# 
# p.s.: –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∑–∞–º–µ—á–∞–Ω–∏—è, –µ—Å–ª–∏ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —á—Ç–æ-—Ç–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ.</h7>

# –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é:  
# 
# https://disk.yandex.ru/i/nksEWyP7dZAAzQ

# <div id="div_id" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ [v5]: </b>
# 
# 
# <s>–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞ —Ö–æ—Ä–æ—à–æ, –º–Ω–æ–≥–∏–µ –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã. –û–¥–Ω–∞–∫–æ —Å—Ç–æ–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∞—Å–ø–µ–∫—Ç—ã:
# 
# - –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ü–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.
# 
# - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–ª–∞–π–¥–æ–≤ —Å —É—á–µ—Ç–æ–º –∑–∞–º–µ—á–∞–Ω–∏–π
# 
# - —Å–ª–∞–π–¥—ã —Å 24 –ø–æ 39 –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –¥—Ä—É–≥–æ–π –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏
# 
# ---
#     
# –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è - —ç—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –≥–¥–µ —Å –ø–æ–º–æ—â—å—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–æ–Ω–æ—Å–∏—Ç—Å—è –Ω—É–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è. –ù–∏–∫—Ç–æ —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª–∞–π–¥–∞—Ö —á–∏—Ç–∞—Ç—å –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∏ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏–∏. –¢–∞–∫–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ "–ó–¥–µ—Å—å –º—ã –≤–∏–¥–∏–º", "–í–∏–¥–∏–º" –∏ —Ç.–¥. –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è - –ø–∏—à—É—Ç —Ç–µ–∑–∏—Å–∞–º–∏.
# 
# –û—Å–Ω–æ–≤–Ω—É—é –º—ã—Å–ª—å\–≤—ã–≤–æ–¥ –¥–æ–Ω–æ—Å—è—Ç —Å –ø–æ–º–æ—â—å—é –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å–ª–∞–π–¥–∞ –∏–ª–∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –∫ –≥—Ä–∞—Ñ–∏–∫–∞–º –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–∞–º.
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –ü–æ–¥–ø—Ä–∞–≤–∏–ª–∞ —Å —É—á–µ—Ç–æ–º –∑–∞–º–µ—á–∞–Ω–∏–π. –ò —É–¥–∞–ª–∏–ª–∞ –ø—É—Ç—Å—ã–µ —Å–ª–∞–π–¥—ã –∏ —Å–ª–∞–π–¥—ã –æ–±—Ä–∞–∑—Ü–∞.
# 
# </div>

# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v6] : </b>
# 
# –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–∏–Ω—è—Ç–∞
# 
# </div>

# ---
# 
# <div id="1" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ö†Ô∏è –ò–¢–û–ì–ò –†–ï–í–¨–Æ ‚ö†Ô∏è : </b>
# 
# **`[1/6]`**
# 
# <s>–í —Ü–µ–ª–æ–º, –ø—Ä–æ–¥–µ–ª–∞–Ω–∞ –Ω–µ–ø–ª–æ—Ö–∞—è —Ä–∞–±–æ—Ç–∞, –Ω–æ –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è —Ç–µ–±–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Å–æ–∑–≤–æ–Ω–∞. –í –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ –±—ã–ª–∏ –æ—Ç–º–µ—á–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –æ—à–∏–±–∫–∏ (–∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö –ø—Ä–æ—à–ª—ã—Ö –∫–æ–≥–æ—Ä—Ç). 
# 
# –£—á–∏—Ç—ã–≤–∞–π –∏—Ö –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –Ω–∞–¥ —Å–≤–æ–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º - –∑–∞—á–µ–º –ø–æ–≤—Ç–æ—Ä—è—Ç—å —á—É–∂–∏–µ –æ—à–∏–±–∫–∏?
# 
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —ç—Ç–∞–ø –ø—Ä–æ–≤–µ–¥–µ–Ω –Ω–∞ —Ö–æ—Ä–æ—à–µ–º —É—Ä–æ–≤–Ω–µ, –º–Ω–æ–≥–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–æ –µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏). –í–æ–ø—Ä–æ—Å—ã –∑–∞–∫–∞–∑—á–∏–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –ø–æ–ª–Ω–æ–º –æ–±—ä–µ–º–µ, –Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø—É–Ω–∫—Ç—ã. 
#     
# –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –Ω–µ —Å–º–æ–≥ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–ª–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É, —Ç.–∫. –ø–∞–¥–∞–µ—Ç –∫–æ–¥ –Ω–∞ 58-–π —è—á–µ–π–∫–µ. –Ø –ø–æ—Å—Ç–∞—Ä–∞–ª—Å—è –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ–≤—å—é –¥–æ —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞, –Ω–æ –∏–º–µ–π –≤–≤–∏–¥—É, —á—Ç–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ (–∫–æ–≥–¥–∞ –∫–æ–¥ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç), –º–æ–≥—É—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –∏ –¥—Ä—É–≥–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è.
# 
# 
# –Ø –æ—Ç–º–µ—Ç–∏–ª –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã.
# 
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ1](#div_id1)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ2](#div_id2)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ3](#div_id3)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ4](#div_id4)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ5](#div_id5)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ6](#div_id6)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ7](#div_id7)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ8](#div_id8)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ9](#div_id9)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ10](#div_id10)
# 
# –ü–æ—Å–º–æ—Ç—Ä–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –º–æ–∏ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
# 
# </div>
# 
# <div id="2" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ö†Ô∏è –ò–¢–û–ì–ò –†–ï–í–¨–Æ ‚ö†Ô∏è : </b>
# 
# **`[2/6]`**
# 
# <s>–ü—Ä–∏–≤–µ—Ç. –°–ø–∞—Å–∏–±–æ –∑–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–∏, –Ω–æ –æ—Å—Ç–∞–ª–∏—Å—å –µ—â–µ –º–æ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç —Ç–≤–æ–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è.
# 
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ11](#div_id11)
# 
#  - [–û—à–∏–±–∫–∞ ‚Ññ12](#div_id12)
# 
# 
# </div>
# 
# <div id="3" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ö†Ô∏è –ò–¢–û–ì–ò –†–ï–í–¨–Æ ‚ö†Ô∏è : </b>
# 
# **`[3/6]`**
# 
# <s>–ü—Ä–∏–≤–µ—Ç! –ù–µ —Å–º–æ–≥ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é, —Ç.–∫. —Å–Ω–æ–≤–∞ –ø–∞–¥–∞–µ—Ç –∫–æ–¥ - —Ç–µ–ø–µ—Ä—å –Ω–∞ 51-–π —è—á–µ–π–∫–µ. 
# 
# - [–û—à–∏–±–∫–∞ ‚Ññ13](#div_id13)
# 
# </div>
# 
# <div id="4" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ö†Ô∏è –ò–¢–û–ì–ò –†–ï–í–¨–Æ ‚ö†Ô∏è : </b>
# 
# **`[4/6]`**
# 
# <s>–ü—Ä–∏–≤–µ—Ç! –Ø –Ω–µ –ø–æ–Ω–∏–º–∞—é –≤ —á–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ —Ä–µ–≤—å—é. –£ —Ç–µ–±—è –∫–∞–∫–∏–µ —Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã? –î–∞–π, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –∑–Ω–∞—Ç—å.
# 
# - [–û—à–∏–±–∫–∞ ‚Ññ14](#div_id14)
# 
# </div>

# <div id="5" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ö†Ô∏è –ò–¢–û–ì–ò –†–ï–í–¨–Æ ‚ö†Ô∏è : </b>
# 
# **`[5/6]`**
# 
# <s>–ü—Ä–∏–≤–µ—Ç! –û—Å—Ç–∞–ª–æ—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é —á–∞—Å—Ç–æ—Ç—É —Å–æ–±—ã—Ç–∏–π –∏ —Å–º–æ–≥—É –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–æ–µ–∫—Ç
# 
# - [–û—à–∏–±–∫–∞ ‚Ññ15](#div_id15)
# 
# </div>
# 
# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> üöÄ –ò–¢–û–ì–ò –†–ï–í–¨–Æ üöÄ : </b>
# 
# –ü—Ä–∏–≤–µ—Ç! –ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω.–í—Å–µ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã.
# 
# ---
# 
# ![](https://media.giphy.com/media/xUKrrEnN9I5lnrcSMv/giphy-downsized-large.gif)
# 
# ---
# 
# 
# –û—Å—Ç–∞–ª—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ - SQL!
# 
# </div>
# 
# ---

# # –ê–Ω–∞–ª–∏–∑ "–ù–µ–Ω—É–∂–Ω—ã–µ –≤–µ—â–∏"

# ## –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:

# 
# 
# –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:
#   –î–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ —Å–æ–±—ã—Ç–∏—è—Ö, —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –≤ –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
# "–ù–µ–Ω—É–∂–Ω—ã–µ –≤–µ—â–∏". –í –Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–æ–¥–∞—é—Ç —Å–≤–æ–∏ –Ω–µ–Ω—É–∂–Ω—ã–µ –≤–µ—â–∏, —Ä–∞–∑–º–µ—â–∞—è –∏—Ö –Ω–∞ –¥–æ—Å–∫–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π.    
# 
# –í –¥–∞—Ç–∞—Å–µ—Ç–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤–ø–µ—Ä–≤—ã–µ —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ø–æ—Å–ª–µ 7 –æ–∫—Ç—è–±—Ä—è 2019 –≥–æ–¥–∞.  
# –ö–æ–ª–æ–Ω–∫–∏ –≤ /datasets/mobile_sources.csv :  
# userId ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,  
# source ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–∏–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.  
# –ö–æ–ª–æ–Ω–∫–∏ –≤ /datasets/mobile_dataset.csv :  
# event.time ‚Äî –≤—Ä–µ–º—è —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è,  
# user.id ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,  
# event.name ‚Äî –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
# –í–∏–¥—ã –¥–µ–π—Å—Ç–≤–∏–π:  
# advert_open ‚Äî –æ—Ç–∫—Ä—ã–ª –∫–∞—Ä—Ç–æ—á–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,  
# photos_show ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏,  
# tips_show ‚Äî —É–≤–∏–¥–µ–ª —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,  
# tips_click ‚Äî –∫–ª–∏–∫–Ω—É–ª –ø–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–º—É –æ–±—ä—è–≤–ª–µ–Ω–∏—é,  
# contacts_show –∏ show_contacts ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ–ª –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞,  
# contacts_call ‚Äî –ø–æ–∑–≤–æ–Ω–∏–ª –ø–æ –Ω–æ–º–µ—Ä—É –∏–∑ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,  
# map ‚Äî –æ—Ç–∫—Ä—ã–ª –∫–∞—Ä—Ç—É –æ–±—ä—è–≤–ª–µ–Ω–∏–π,  
# search_1 ‚Äî search_7 ‚Äî —Ä–∞–∑–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ–∏—Å–∫–æ–º –ø–æ —Å–∞–π—Ç—É,  
# favorites_add ‚Äî –¥–æ–±–∞–≤–∏–ª –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ.
# 
# 
# –¶–µ–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è  
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–ª—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è  
# –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
# - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ  –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
# - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –æ–±–µ–∏—Ö –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö? 
# - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤
# - –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã–µ –ø–æ user_id
# 
# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ, —á—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∏ –¥–∞–Ω–Ω—ã—Ö, –æ–±–æ–∑–Ω–∞—á–µ–Ω—ã —Ü–µ–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è. –¢–∞–∫ –±—É–¥–µ—Ç —Å—Ä–∞–∑—É –ø–æ–Ω—è—Ç–Ω–æ –æ —á–µ–º –ø—Ä–æ–µ–∫—Ç.
# 
# </div>
# 
# 
# –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
# - –°–∫–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö? –í—ã—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–∞–∂–¥–æ–≥–æ –ª–æ–≥–∞.
# - –°–∫–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
# - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ —É –Ω–∞—Å?
# - –û—Ü–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏–±—ã—Ç–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏
# - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤–æ—Ä–æ–Ω–∫—É —Å–æ–±—ã—Ç–∏–π. –°—á–∏—Ç–∞–µ–º –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
# 
# 
# 
# –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:
# 
# 1 –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å–≤—è–∑—å —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ ‚Äî –∏ –¥—Ä—É–≥–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:    
# 
#     -–í —Ä–∞–∑—Ä–µ–∑–µ —Å–µ—Å—Å–∏–π –æ—Ç–æ–±—Ä–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏\–ø–∞—Ç—Ç–µ—Ä–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ
#     –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤  
#     -–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≤–æ—Ä–æ–Ω–∫–∏ –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º –≤ —Ä–∞–∑—Ä–µ–∑–µ
#     —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π    
#     
# 2 –û—Ü–µ–Ω–∏—Ç–µ, –∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è —á–∞—â–µ —Å–æ–≤–µ—Ä—à–∞—é—Ç —Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã:  
# 
#     - –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—É—é —á–∞—Å—Ç–æ—Ç—É —Å–æ–±—ã—Ç–∏–π –≤ —Ä–∞–∑—Ä–µ–∑–µ –¥–≤—É—Ö –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:  
#     
#         a –≥—Ä—É–ø–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–º–æ—Ç—Ä–µ–ª–∏
#         –∫–æ–Ω—Ç–∞–∫—Ç—ã contacts_show
#         b –≥—Ä—É–ø–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–º–æ—Ç—Ä–µ–ª–∏
#         –∫–æ–Ω—Ç–∞–∫—Ç—ã contacts_show
# 
#   
# 3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑
# 
#     a. –û–¥–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–≤–µ—Ä—à–∞—é—Ç –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click , –¥—Ä—É–≥–∏–µ ‚Äî—Ç–æ–ª—å–∫–æ tips_show . –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—É: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è —É —ç—Ç–∏—Ö –¥–≤—É—Ö –≥—Ä—É–ø–ø.
# 
#     –ì–∏–ø–æ—Ç–µ–∑–∞
# - H0 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã  –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show 
# - H1 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã  –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show 
# 
# 
# 
#     b. –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Ö—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π map –±–æ–ª—å—à–µ, —á–µ–º —É –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –µ–π.
#     
#     –ì–∏–ø–æ—Ç–µ–∑–∞
# - H0 -  –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏–µ map —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏
# - H1 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è map –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏
# 
# 

# ## –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö.

# In[1]:


import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import matplotlib.pyplot as plt
import seaborn as sns
import requests
from tqdm import tqdm
import plotly.express as px
import plotly.graph_objects as go
from scipy import stats as st
import math as mth


# –£ –Ω–∞—Å –¥–≤–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö source –∏ data . –ó–∞–≥—Ä—É–∑–∏–º –∏ –∏–∑—É—á–∏–º –∏—Ö.

# In[2]:


data=pd.read_csv('https://code.s3.yandex.net/datasets/mobile_dataset.csv')
data


# In[3]:


source=pd.read_csv('https://code.s3.yandex.net/datasets/mobile_sources.csv')
source


# –ü—Ä–æ–≤–µ—Ä–∏–º –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –¥—É–±–ø–ª–∏–∫–∞—Ç—ã

# In[4]:


def initial_analysis(data):
    print(data.head())
    print(data.info())
    for col in data.columns:
        data_nulls= np.mean(data[col].isnull())
        print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤:{} - {}%'.format(col, round(data_nulls*100)))
    print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ:{}%'.format(round(data.duplicated().sum()*100)))


# In[5]:


initial_analysis(data)


# In[6]:


initial_analysis(source)


# –í–∏–¥–∏–º, —á—Ç–æ –æ—Ç—Å—É—Ç—Å–≤—Ç—É—é—Ç –¥—É–±–ø–ª–∏–∫–∞—Ç—ã –∏ –ø—Ä–æ–ø—É—Å–∫ —Ç–∞–±–ª–∏—Ü–∞—Ö. –ü—Ä–∏—Å—Ç—É–ø–∏–º –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö

# <div class="alert alert-warning" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úèÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —Ç–∏–º–ª–∏–¥–∞: </b>
# 
# –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ–ø–µ—á–∞—Ç–æ–∫ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∏—Ö. –≠—Ç–æ —É–ª—É—á—à–∏—Ç –æ–±—â–µ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –∏ –ø–æ–∫–∞–∂–µ—Ç —Ç–≤–æ—é –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –¥–µ—Ç–∞–ª—è–º.
# 
# </div>

# –ü–µ—Ä–µ–∏–º–µ–Ω—É–µ–º —Å—Ç–æ–ª–±—Ü—ã

# In[7]:


source.columns=['user_id', 'source_engine',]


# In[8]:


data.columns=['event_time','event_name','user_id']


# –ü—Ä–æ–≤–µ—Ä–∏–º —Å–æ–≤–ø–∞–∞—é—Ç –ª–∏ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

# In[9]:


data['user_id'].nunique()


# In[10]:


source['user_id'].nunique()


# –°–º–µ—à–∏–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã

# In[11]:


data=data.merge(source, on='user_id',how='left')


# –ü—Ä–∏–≤–æ–¥–∏–º —Å—Ç–æ–ª–±–µ—Ü –æ—Å –≤—Ä–µ–º–µ–Ω–µ–º –∫ –Ω—É–∂–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É.

# In[12]:


data['event_time'] = pd.to_datetime(data['event_time'])
data['event_time'] = data['event_time'].dt.round('S')


# –ü—Ä–æ–≤–µ—Ä–∏–º –Ω–∞ –¥—É–±–ø–ª–∏–∫–∞—Ç—ã —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–µ–π—Å—Ç–≤–∏—è

# In[13]:


data['event_name'].unique()


# –í–∏–¥–∏–º, —á—Ç–æ –µ—Å—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –ø–æ —Ä–∞–∑–Ω–æ–º—É. –ü–µ—Ä–µ–∏–º–µ–Ω—É–µ–º

# In[14]:


data['event_name'] = data['event_name'].replace('show_contacts', 'contacts_show')


# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞  : </b>
# 
# –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –¥–∞–Ω–Ω—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å
# 
# </div>

# –û–±–™–µ–¥–Ω–∏–º –ª–æ–≥ 'search_1', 'search_2', 'search_3',  'search_4', 'search_5', 'search_6', 'search_7', –≤ –æ–¥–∏–Ω –ª–æ–≥ search

# In[15]:


data['event_name'] = data['event_name'].replace('search_1','search')
data['event_name'] = data['event_name'].replace('search_2','search')
data['event_name'] = data['event_name'].replace('search_3','search')
data['event_name'] = data['event_name'].replace('search_4','search')
data['event_name'] = data['event_name'].replace('search_5','search')
data['event_name'] = data['event_name'].replace('search_6','search')
data['event_name'] = data['event_name'].replace('search_7','search')


# <div class="alert alert-warning" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úèÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —Ç–∏–º–ª–∏–¥–∞: </b>
# 
# –¢—ã –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–±–∏—Ä–∞–µ—à—å –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—à—å —Ä–∞–∑–Ω—ã–µ `search` —ç–ª–µ–º–µ–Ω—Ç—ã. –ï—Å–ª–∏ –±—ã —Ç–∞–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±—ã–ª–æ –º–Ω–æ–≥–æ, —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —Å—Ç–∞–ª –±—ã –Ω–µ—É–¥–æ–±–Ω—ã–º –∏ —Ç—Ä—É–¥–æ–µ–º–∫–∏–º.
# 
# –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–π –∑–∞–¥–∞—á–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä:
# 
# ![image.png](attachment:image.png)
# 
# </div>

# –ü—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å–≤—É–µ—Ç –∑–∞—è–≤–ª–µ–Ω–Ω–æ–º—É –≤ –æ–ø–∏—Å–∞–Ω–∏–∏.

# In[16]:


print('–ú–∏–Ω–∞–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è:',data['event_time'].min(), '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è:',data['event_time'].max())


# –í—ã–≤–æ–¥ –ø–æ —à–∞–≥—É  
# - –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –¥—É–±–ø–ª–∏–∫–∞—Ç—ã. –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞—à–ª–∏  
# - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª–∏ —Å—Ç–æ–ª–±—Ü—ã.   
# - –û–±—ä–µ–¥–∏–Ω–∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è contacts_show –∏ show_contacts    
# - –û–±—ä–µ–¥–∏–Ω–∏–ª–∏  'search_1', 'search_2', 'search_3', 'search_4', 'search_5', 'search_6', 'search_7', –≤ –æ–¥–∏–Ω –ª–æ–≥ search  
# - –ø—Ä–∏–≤–µ–ª–∏ —Å—Ç–æ–ª–±–µ—Ü —Å –¥–∞—Ç–∞–º–∏ –∫ –Ω—É–∂–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É  
# - –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ —á—Ç–æ –ø–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å–≤—É–µ—Ç –∑–∞—è–≤–ª–µ–Ω–Ω–æ–º—É –≤ –æ–ø–∏—Å–∞–Ω–∏–∏.
# 
# 

# <div class="alert alert-warning" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úèÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —Ç–∏–º–ª–∏–¥–∞: </b>
# 
# –ü–æ—Å–ª–µ –≤—Å–µ—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π, —è –±—ã —Ç–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤. –≠—Ç–æ—Ç —à–∞–≥ –ø–æ–º–æ–∂–µ—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞.
# 
# </div>

# ## –ò—Å—Å–ª–µ–¥—É–µ–º –¥–∞–Ω–Ω—ã–µ

# ### –ü–æ—Å–º–æ—Ç—Ä–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–≥–æ–≤

# In[17]:


event_data=data['event_name'].value_counts().reset_index()
event_data.columns=['event_name','count']


# In[18]:


# Make a random dataset:
plt.figure(figsize=(10, 6))
sns.barplot(x = 'event_name', y = 'count', data = event_data )
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤')
plt.xlabel('–õ–æ–≥–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–≥–æ–≤')
plt.xticks(rotation = 90)
plt.show()


# <div class="alert alert-warning" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úèÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —Ç–∏–º–ª–∏–¥–∞: </b>
# 
# –•–æ—á–µ—Ç—Å—è –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–∞ –≤ –≥—Ä–∞—Ñ–∏–∫–µ. –í —Ç–µ–∫—É—â–µ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ü–≤–µ—Ç –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–º—ã—Å–ª–∞ –∫ –¥–∞–Ω–Ω—ã–º –∏ –º–æ–∂–µ—Ç –æ—Ç–≤–ª–µ–∫–∞—Ç—å –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
# 
# –ü—Ä–µ–¥–ª–∞–≥–∞—é –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–∞ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –µ–≥–æ —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —ç—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –¥–æ–Ω–µ—Å—Ç–∏ –∫–∞–∫—É—é-–ª–∏–±–æ –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–ª–∏ —É–ª—É—á—à–∞–µ—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é –≥—Ä–∞—Ñ–∏–∫–∞.
# 
# </div>

# –í–∏–¥–∏–º, —á—Ç–æ —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π –ª–æ–≥ —ç—Ç–æ tips_show (—É–≤–∏–¥–µ–ª —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è), –∑–∞—Ç–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ –∏ search. –ê —Å–∞–º—ã–π –º–µ–Ω–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π –ª–æ–≥ —ç—Ç–æ tips_click and contact_call. –¶–µ–ª–µ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ —Ä–∞—Å–ø–æ–ª–æ–∂–∏–ª–æ—Å—å 5-–º —Å –∫–æ–Ω—Ü–∞

# <div class="alert alert-warning" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úèÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —Ç–∏–º–ª–∏–¥–∞: </b>
# 
# –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –µ—â–µ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å–æ–±—ã—Ç–∏–µ `tips_show` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Ö –¥–µ–π—Å—Ç–≤–∏–π.
# 
# –ü–æ—ç—Ç–æ–º—É –≤ **–Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö** —Ä–∞—Å—á–µ—Ç–∞—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –º–æ–∂–Ω–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
# 
# </div>

# ### –ò–∑—É—á–∏–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# –°–∞–º—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

# In[19]:


events_by_users=data.groupby('user_id')['event_name'].count().sort_values(
    ascending=False).reset_index()
events_by_users.head(15)


# In[20]:


ax=events_by_users.head(15)
plt.figure(figsize=(10, 5))
sns.barplot(x='user_id', y='event_name', data=ax)
sns.set_palette('muted')
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π —É —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.xlabel('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π')
plt.xticks(rotation = 90)
plt.show()


# <div class="alert alert-warning" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úèÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è  —Ç–∏–º–ª–∏–¥–∞: </b>
# 
# –ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ–º–µ–Ω—è—Ç—å –æ—Å–∏ X –∏ Y –º–µ—Å—Ç–∞–º–∏ –¥–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è —á—Ç–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
# 
# </div>

# –í–∏–¥–∏–º, —á—Ç–æ —Å–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–∫–æ–ª–æ —Ç–æ–ø15 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∏–ª–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ –æ—Ç 250 –¥–æ 500 –¥–µ–π—Å—Ç–≤–∏–π

# –î–∞–Ω–Ω—ã–µ –æ–± –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# In[21]:


events_by_users.describe()


# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞  : </b>
# 
# –≠—Ç–æ –≥—Ä–∞–º–æ—Ç–Ω—ã–π —Ö–æ–¥ - –æ—Ü–µ–Ω–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ `describe`.
# 
# –°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ (mean) –º–æ–∂–µ—Ç –±—ã—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∫ –≤—ã–±—Ä–æ—Å–∞–º –∏ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ç–æ—á–Ω–æ –æ—Ç—Ä–∞–∂–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω—É –ø—Ä–∏ –Ω–µ—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö –¥–∞–Ω–Ω—ã—Ö.
# 
# </div>

# –ó–¥–µ—Å—å –º—ã –≤–∏–ª–∏–º, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–≤–µ—Ä–∞—à–∞–µ—Ç 17 –¥–µ–π—Å—Ç–≤–∏–π, –∞ –º–µ–¥–∏–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–æ–≤–æ—Ä–∏—Ç,—á—Ç–æ 9 –¥–µ–π—Å—Ç–≤–∏–π. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π —ç—Ç–æ 1

# ### –ü—Ä–æ–≤–µ—Ä–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤—Ç–µ–ª–µ–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏.

# In[22]:


activity_data=data
activity_data['activity_day']=data['event_time'].dt.date
activity_data


# In[23]:


activity_data=pd.pivot_table(data,
               index=["activity_day"],
               values=["user_id"],
               aggfunc='nunique').reset_index()
activity_data.columns=['activity_date', 'user_count']

plt.figure(figsize=(10, 5))
sns.barplot(x='user_count', y='activity_date', data=activity_data)
sns.set_palette('muted')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π —Å–∞–π—Ç–∞ ')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.ylabel('–î–µ–Ω—å')
plt.show()


# –í–∏–¥–∏–º, —á—Ç–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–∏–ª—å–Ω–æ –º–µ–Ω—å—à–µ –±—ã–ª–∞ 12 –æ–∫—Ç—è–±—Ä—è –∏ —Ç–∞–∫–∂–µ —Å–∏–ª—å–Ω—ã –ø—Ä–æ–≤–∞–ª –≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞–±–ª—é–¥–∞–ª—Å—è –≤ 2 –Ω–æ—è–±—Ä—è. –ü—Ä–æ–≤–µ—Ä–∏–≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –≤–∏–¥–∏–º, —á—Ç–æ –æ–±–∞ –¥–Ω—è –±—ã–ª–∏ —Å—É–±–±–æ—Ç–∞–º–∏. –ù–∞–¥–æ –ø—Ä–µ–≤—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏. 

# In[24]:


activity_weekday=data
activity_weekday['activity_weekday']=activity_weekday['event_time'].dt.weekday
activity_weekday


# In[25]:


activity_weekday_table=pd.pivot_table(activity_weekday,
               index=["activity_weekday"],
               values=["user_id"],
               aggfunc='nunique').reset_index()
activity_weekday_table.columns=['activity_weekday', 'user_count']


# In[26]:


plt.figure(figsize=(10, 5))
sns.barplot(x='activity_weekday', y='user_count', data=activity_weekday_table)
sns.set_palette('muted')
plt.title('–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ—Å–µ—â–µ–Ω–∏–π —Å–∞–π—Ç–∞')
plt.xlabel('–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π')
plt.show()


# <div id="div_id1" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ1](#1)
# 
# –ü–æ–¥–ø–∏—Å–∏ –∫ –æ—Å—è–º –ø–µ—Ä–µ–ø—É—Ç–∞–Ω—ã –º–µ—Å—Ç–∞–º–∏. –ü–æ–¥–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –ø–æ–∂–∞–ª—É–π—Å—Ç–∞
#     
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –ü–æ–¥–ø—Ä–∞–≤–∏–ª–∞
# 
# </div>

# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v2] : </b>
# 
# üëç
# 
# </div>

# –í–∏–¥–∏–º –∑–∞–º–µ—Ç–Ω–æ–µ –ø—Ä–æ—Å–µ–¥–∞–Ω–∏–µ –≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –Ω–µ–¥–µ–ª–∏, –≤ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å—É–±–±–æ—Ç—É.

# –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏

# In[27]:


dau=data.groupby('activity_day').agg({'event_name':'count'})
sns.set_theme()
sns.set_palette('muted')
sns.set(rc={'figure.figsize':(10,5)})
plt.plot(dau)
plt.title('–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ  –¥–µ–π—Å—Ç–≤–∏–π')
plt.show()


# –ü—Ä–æ–≤–µ—Ä–∏–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏. –¢—É—Ç –≤–∏–¥–∏–º —Å–∏–ª—å–Ω–æ–µ –ø—Ä–æ—Å–∏–¥–∞–Ω–∏–µ –≤ –∫–æ–ª-–≤–æ –ø–æ–ª—å–∑–æ–≤—Ç–µ–ª—è—Ö –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ 12 –æ–∫—Ç—è–±—Ä—è –∏ 2 –Ω–æ—è–±—Ä—è, –≤–æ–∑–º–æ–∂–Ω–æ –≤ —ç—Ç–∏ –¥–∞—Ç—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª –º–∞—Å—Å–æ–≤—ã–π —Å–±–æ–π –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, —á—Ç–æ –ø–æ–≤–ª–∏—è–ª–æ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ò —Ü–∏–∫–ª–∏—á–Ω–æ—Å—Ç—å –ø—Ä–æ—Å–µ–¥–∞–Ω–∏–π –ø–æ –≤—ã—Ö–æ–¥–Ω—ã–º

# –ü–æ–¥—Å—á–µ—Ç —Å–µ—Å—Å–∏–π, —Å–æ–∑–¥–∞–µ–º –∫–æ–ª–æ–Ω–∫—É session_id

# In[28]:


data=data.sort_values(['user_id', 'event_time'])


# In[29]:


data.head(15)


# In[30]:


#convert to datetimes
data['event_timestamp'] = pd.to_datetime(data['event_time'])
#identify difference 5Min for each group with cumulative sum
g = (data.groupby('user_id')['event_timestamp'].diff() > pd.Timedelta('30Min')).cumsum()
#create counter of groups
data['session_id'] = data.groupby(['user_id', g], sort=False).ngroup() + 1


# <div id="div_id2" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ2](#1)
# 
# –í —Ä–µ–∞–ª—å–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ —Ç–µ–±–µ –ø—Ä–∏–¥–µ—Ç—Å—è –æ–±–æ—Å–Ω–æ–≤–∞—Ç—å –ø–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ 5 –º–∏–Ω (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–ª –Ω–∞ —Å–æ–∑–≤–æ–Ω–µ). –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ.
# 
# –û—Ç —ç—Ç–æ–≥–æ –∑–∞–≤–∏—Å–∏—Ç —Å–∫–æ–ª—å–∫–æ –≤ —Ü–µ–ª–æ–º —É —Ç–µ–±—è –ø–æ–ª—É—á–∏—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–µ—Å—Å–∏–π –∏ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –¥–∞–ª—å–Ω–µ–π—à–∏–µ —Ä–∞—Å—á–µ—Ç—ã.
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –ò–∑—É—á–∏–≤ –≤–æ–ø—Ä–æ—Å –Ω–∞—à–ª–∞, —á—Ç–æ Google Metrics –≤—ã–¥–µ–ª—è—é—Ç —Å–µ—Å—Å–∏–π —á–µ—Ä–µ–∑ —Ç–∞–π–º-–∞—É—Ç —Å—Ä–µ–º—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –±–æ–ª–µ–µ 30 –º–∏–Ω—É—Ç. –°–º–µ–Ω–∏–ª–∞ —Å 5 –º–∏–Ω—É—Ç –Ω–∞ 30.
# 
#     An Ultimate Guide to Session Timeout in Google Analytics
# https://www.dataflo.io/blog/session-timeout-in-google-analytics
# –ü—É–Ω–∫—Ç: "How Session Timeout Works in Google Analytics"
#     
# </div>
# 
# 

# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v2] : </b>
# 
# üëç
# 
# </div>

# –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –¥–µ–π—Å—Ç–≤–∏–π –≤–Ω—É—Ç—Ä–∏ —Å–µ—Å—Å–∏–π

# In[31]:


data_clean=data.drop_duplicates(subset=['event_name','session_id'])
data_clean


# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞  : </b>
# 
# –°–∞–º–∏ –ø–æ —Å–µ–±–µ —Å–µ—Å—Å–∏–∏ –≤—ã–¥–µ–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
# 
# </div>

# ### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª-–≤–æ —Å–æ–±—ã—Ç–∏–π –ø–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º

# In[32]:


session_data=data_clean.groupby('event_name').agg({'session_id': 'nunique'}).sort_values(
    by='session_id', ascending=False).reset_index()
session_data
ax=session_data
plt.figure(figsize=(15, 8))
sns.barplot(x='session_id', y='event_name', data=ax)
sns.set_palette('muted')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª-–≤–æ —Å–æ–±—ã—Ç–∏–π –ø–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π')
plt.ylabel('–°–æ–±—ã—Ç–∏—è')
plt.xticks(rotation = 90)
plt.show()


# <div id="div_id3" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ3](#1)
# 
# –≠—Ç–æ –Ω–µ–ª—å–∑—è –Ω–∞–∑—ã–≤–∞—Ç—å –≤–æ—Ä–æ–Ω–∫–æ–π. –ó–¥–µ—Å—å –Ω–µ—Ç —Ä–µ—á–∏ –æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —ç—Ç–∞–ø–æ–≤. –¢—ã –ø—Ä–æ—Å—Ç–æ –≤—ã–≤–µ–ª–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è.
# 
# –í–æ—Ä–æ–Ω–∫–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è —Ü–µ–ª–µ–≤—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –ü–æ–º–µ–Ω—è–ª–∞ —Ñ–æ—Ä–º–∞—Ç –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ –±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π. –•–æ—Ç–µ–ª–∞ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–æ–º —Ç–∞–±–ª–∏—Ü—É –Ω–∏–∂–µ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–Ω–æ—Å—Ç–∏
# 
# </div>

# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v2] : </b>
# 
# –î–∞, —Ç–∞–∫ –≥–æ—Ä–∞–∑–¥–æ –ª—É—á—à–µ
# 
# </div>

# In[33]:


session_data


# –¢–µ–ø–µ—Ä—å –æ—Ç—Ñ–∏–ª—å—Ä–æ–≤–∞–≤ –ø–æ —Å–µ—Å—Å–∏—è–º –∏ —É–±—Ä–∞–≤ –¥—É–±–ª–∏–∫–∞—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Å–µ—Å—Å–∏–∏ –≤–∏–¥–∏–º, —á—Ç–æ —Å–∞–º—ã–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è tips_show, –∞ –Ω–∞–∏–º–µ–Ω–µ–µ favorites_add, tips_click, contacts_call.  
# –°—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–æ–π —Ä–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É tips_show –∏ tips_click, —á—Ç–æ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ª—é–¥–µ–π –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑—É—á–∏—Ç—å —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å

# –û–±—â–∏–π –≤—ã–≤–æ–¥ –ø–æ —à–∞–≥—É. 
# - –ü–æ—Å—Ç—Ä–æ–∏–≤ —Ç–∞–±–ª–∏—Ü—É —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ª–æ–≥–æ–≤ –≤–∏–¥–∏–º, —á—Ç–æ —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π –ª–æ–≥ —ç—Ç–æ tips_show (—É–≤–∏–¥–µ–ª —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è), –∑–∞—Ç–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ –∏ search. –ê —Å–∞–º—ã–π –º–µ–Ω–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π –ª–æ–≥ —ç—Ç–æ tips_click and contact_call. –¶–µ–ª–µ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ —Ä–∞—Å–ø–æ–ª–æ–∂–∏–ª–æ—Å—å 5-–º —Å –∫–æ–Ω—Ü–∞ 
# - –ù–∞ —Ç–∞–±–ª–∏—Ü–µ —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –í–∏–¥–∏–º, —á—Ç–æ —Å–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–∫–æ–ª–æ —Ç–æ–ø15 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∏–ª–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ –æ—Ç 250 –¥–æ 500 –¥–µ–π—Å—Ç–≤–∏–π
# - –ü–æ—Å–º–æ—Ç—Ä–µ–≤ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é describe() –º—ã –≤–∏–ª–∏–º, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–≤–µ—Ä–∞—à–∞–µ—Ç 17 –¥–µ–π—Å—Ç–≤–∏–π, –∞ –º–µ–¥–∏–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–æ–≤–æ—Ä–∏—Ç,—á—Ç–æ 9 –¥–µ–π—Å—Ç–≤–∏–π. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π —ç—Ç–æ 1
# - –ü—Ä–æ–≤–µ—Ä–∏–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º –≤–∏–¥–∏–º, —á—Ç–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–∏–ª—å–Ω–æ –º–µ–Ω—å—à–µ –±—ã–ª–∞ 12 –æ–∫—Ç—è–±—Ä—è –∏ —Ç–∞–∫–∂–µ —Å–∏–ª—å–Ω—ã –ø—Ä–æ–≤–∞–ª –≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞–±–ª—é–¥–∞–ª—Å—è –≤ 2 –Ω–æ—è–±—Ä—è. –ü—Ä–æ–≤–µ—Ä–∏–≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –≤–∏–¥–∏–º, —á—Ç–æ –æ–±–∞ –¥–Ω—è –±—ã–ª–∏ —Å—É–±–±–æ—Ç–∞–º–∏. –ù–∞–¥–æ –ø—Ä–µ–≤—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏. 
# -  –≤ –≥—Ä–∞—Ñ–∏–∫–µ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª—è–º –í–∏–¥–∏–º –∑–∞–º–µ—Ç–Ω–æ–µ –ø—Ä–æ—Å–µ–¥–∞–Ω–∏–µ –≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –Ω–µ–¥–µ–ª–∏, –≤ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å—É–±–±–æ—Ç—É.
# - –ü–æ–¥—Å—á–∏—Ç–∞–ª–∏ —Å–µ—Å—Å–∏–π, —Å–æ–∑–¥–∞–ª–∏ –∫–æ–ª–æ–Ω–∫—É session_id –∏ –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ –≤–æ—Ä–æ–Ω–∫—É —Å–æ–±—ã—Ç–∏–π.   
# –≤–∏–¥–∏–º, —á—Ç–æ —Å–∞–º—ã–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è tips_show, –∞ –Ω–∞–∏–º–µ–Ω–µ–µ favorites_add, tips_click, contacts_call.  
# –°—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–æ–π —Ä–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É tips_show –∏ tips_click, —á—Ç–æ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ª—é–¥–µ–π –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑—É—á–∏—Ç—å —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å

# ## –ê–Ω–∞–ª–∏–∑ —Å–≤—è–∑–∏ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏

# ### –î–∏–∞–≥—Ä–∞–º–º–∞ –°–∞–Ω–∫–µ—è

# –°—Ç—Ä–æ–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É —Å–∞–Ω–∫–µ—è—é. 
# –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—É –∏ –ø—Ä–∏–º–µ–Ω–µ–º –Ω–æ–≤—ã–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ —Å–µ—Å—Å–∏—è–º —Ç–∞–±–ª–∏—Ü—É 

# In[34]:


def add_features(df):
    
    """–§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã

    Args:
        df (pd.DataFrame): –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞.
    Returns:
        pd.DataFrame: —Ç–∞–±–ª–∏—Ü–∞ —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏.
    """
    
    # —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ id –∏ –≤—Ä–µ–º–µ–Ω–∏
    sorted_df = df.sort_values(by=['session_id', 'event_timestamp']).copy()
    # –¥–æ–±–∞–≤–ª—è–µ–º —à–∞–≥–∏ —Å–æ–±—ã—Ç–∏–π
    sorted_df['step'] = sorted_df.groupby('session_id').cumcount() + 1
    
    # –¥–æ–±–∞–≤–ª—è–µ–º —É–∑–ª—ã-–∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Ü–µ–ª–µ–≤—ã–µ —É–∑–ª—ã
    # —É–∑–ª—ã-–∏—Å—Ç–æ—á–Ω–∏–∫–∏ - —ç—Ç–æ —Å–∞–º–∏ —Å–æ–±—ã—Ç–∏—è
    sorted_df['source'] = sorted_df['event_name']
    # –¥–æ–±–∞–≤–ª—è–µ–º —Ü–µ–ª–µ–≤—ã–µ —É–∑–ª—ã
    sorted_df['target'] = sorted_df.groupby('session_id')['source'].shift(-1)
    
    # –≤–æ–∑–≤—Ä–∞—Ç —Ç–∞–±–ª–∏—Ü—ã –±–µ–∑ –∏–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏–π
    return sorted_df.drop(['event_name'], axis=1)
  
# –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ç–∞–±–ª–∏—Ü—É
table = add_features(data_clean)
table


# In[35]:


def get_source_index(df):
    
    """–§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–Ω–¥–µ–∫—Å–æ–≤ source

    Args:
        df (pd.DataFrame): –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ step, source, target.
    Returns:
        dict: —Å–ª–æ–≤–∞—Ä—å —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏, –∏–º–µ–Ω–∞–º–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤–∏—è–º–∏ –∏–Ω–¥–µ–∫—Å–æ–≤ –∏–º–µ–Ω–∞–º source.
    """
    
    res_dict = {}
    
    count = 0
    # –ø–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
    for no, step in enumerate(df['step'].unique().tolist()):
        # –ø–æ–ª—É—á–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –¥–ª—è —à–∞–≥–∞
        res_dict[no+1] = {}
        res_dict[no+1]['sources'] = df[df['step'] == step]['source'].unique().tolist()
        res_dict[no+1]['sources_index'] = []
        for i in range(len(res_dict[no+1]['sources'])):
            res_dict[no+1]['sources_index'].append(count)
            count += 1
            
    # —Å–æ–µ–¥–∏–Ω–∏–º —Å–ø–∏—Å–∫–∏
    for key in res_dict:
        res_dict[key]['sources_dict'] = {}
        for name, no in zip(res_dict[key]['sources'], res_dict[key]['sources_index']):
            res_dict[key]['sources_dict'][name] = no
    return res_dict
  

# —Å–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å
source_indexes = get_source_index(table)


# In[36]:


def colors_for_sources(mode):
    
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤ rgba

    Args:
        mode (str): —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ —Ü–≤–µ—Ç–∞, –µ—Å–ª–∏ 'random', –∞ –µ—Å–ª–∏ 'custom' - 
                    –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ
    Returns:
        dict: —Å–ª–æ–≤–∞—Ä—å —Å —Ü–≤–µ—Ç–∞–º–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∫–∞–∂–¥–æ–º—É –∏–Ω–¥–µ–∫—Å—É
    """
    # —Å–ª–æ–≤–∞—Ä—å, –≤ –∫–æ—Ç–æ—Ä—ã–π —Å–ª–æ–∂–∏–º —Ü–≤–µ—Ç–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∏–Ω–¥–µ–∫—Å–æ–º
    colors_dict = {}
    
    if mode == 'random':
        # –≥–µ–Ω–µ—Ä–∏–º —Å–ª—É—á–∞–π–Ω—ã–µ —Ü–≤–µ—Ç–∞
        for label in table['source'].unique():
            r, g, b = np.random.randint(255, size=3)            
            colors_dict[label] = f'rgba({r}, {g}, {b}, 1)'
            
    elif mode == 'custom':
        # –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º —Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞
        colors = requests.get('https://raw.githubusercontent.com/rusantsovsv/senkey_tutorial/main/json/colors_senkey.json').json()
        for no, label in enumerate(table['source'].unique()):
            colors_dict[label] = colors['custom_colors'][no]
            
    return colors_dict
  
  
# –≥–µ–Ω–µ—Ä—é —Ü–≤–µ—Ç–∞ –∏–∑ —Å–≤–æ–µ–≥–æ —Å–ø–∏—Å–∫–∞
colors_dict = colors_for_sources(mode='custom')


# In[37]:


def percent_users(sources, targets, values):
    
    """
    –†–∞—Å—á–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö id –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (–¥–ª—è –≤—ã–≤–æ–¥–∞ –≤ hover text –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞)
    
    Args:
        sources (list): —Å–ø–∏—Å–æ–∫ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ source.
        targets (list): —Å–ø–∏—Å–æ–∫ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ target.
        values (list): —Å–ø–∏—Å–æ–∫ —Å "–æ–±—ä–µ–º–∞–º–∏" –ø–æ—Ç–æ–∫–æ–≤.
        
    Returns:
        list: —Å–ø–∏—Å–æ–∫ —Å "–æ–±—ä–µ–º–∞–º–∏" –ø–æ—Ç–æ–∫–æ–≤ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
    """
    
    # –æ–±—ä–µ–¥–∏–Ω–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ –º–µ—Ç–∫–∏ –∏ –Ω–∞–π–¥–µ–º –ø–∞—Ä—ã
    zip_lists = list(zip(sources, targets, values))
    
    new_list = []
    
    # –ø–æ–¥–≥–æ—Ç–æ–≤–∏–º —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä—å —Å –æ–±—â–∏–º –æ–±—ä–µ–º–æ–º —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —É–∑–ª–∞—Ö
    unique_dict = {}
    
    # –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–º—É —É–∑–ª—É
    for source, target, value in zip_lists:
        if source not in unique_dict:
            # –Ω–∞—Ö–æ–¥–∏–º –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Å—á–∏—Ç–∞–µ–º –æ–±—â–∏–π —Ç—Ä–∞—Ñ–∏–∫
            unique_dict[source] = 0
            for sr, tg, vl in zip_lists:
                if sr == source:
                    unique_dict[source] += vl
                    
    # —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã
    for source, target, value in zip_lists:
        new_list.append(round(100 * value / unique_dict[source], 1))
    
    return new_list


# In[38]:


def lists_for_plot(source_indexes=source_indexes, colors=colors_dict, frac=10):
    
    """
    –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
    –∏—Ö –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è
    
    Args:
        source_indexes (dict): —Å–ª–æ–≤–∞—Ä—å —Å –∏–º–µ–Ω–∞–º–∏ –∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏ source.
        colors (dict): —Å–ª–æ–≤–∞—Ä—å —Å —Ü–≤–µ—Ç–∞–º–∏ source.
        frac (int): –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π "–æ–±—ä–µ–º" –º–µ–∂–¥—É —É–∑–ª–∞–º–∏.
        
    Returns:
        dict: —Å–ª–æ–≤–∞—Ä—å —Å–æ —Å–ø–∏—Å–∫–∞–º–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã.
    """
    
    sources = []
    targets = []
    values = []
    labels = []
    link_color = []
    link_text = []

    # –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–º—É —à–∞–≥—É
    for step in tqdm(sorted(table['step'].unique()), desc='–®–∞–≥'):
        if step + 1 not in source_indexes:
            continue

        # –ø–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞
        temp_dict_source = source_indexes[step]['sources_dict']

        # –ø–æ–ª—É—á–∞–µ–º –∏–Ω–¥–µ–∫—Å—ã —Ü–µ–ª–∏
        temp_dict_target = source_indexes[step+1]['sources_dict']

        # –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ –∫–∞–∂–¥–æ–π –≤–æ–∑–º–æ–∂–Ω–æ–π –ø–∞—Ä–µ, —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –ø–∞—Ä
        for source, index_source in tqdm(temp_dict_source.items()):
            for target, index_target in temp_dict_target.items():
                # –¥–µ–ª–∞–µ–º —Å—Ä–µ–∑ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ id            
                temp_df = table[(table['step'] == step)&(table['source'] == source)&(table['target'] == target)]
                value = len(temp_df)
                # –ø—Ä–æ–≤–µ—Ä—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –ø–æ—Ç–æ–∫–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                if value > frac:
                    sources.append(index_source)
                    targets.append(index_target)
                    values.append(value)
                    # –¥–µ–ª–∞–µ–º –ø–æ—Ç–æ–∫ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    link_color.append(colors[source].replace(', 1)', ', 0.2)'))
                    
    labels = []
    colors_labels = []
    for key in source_indexes:
        for name in source_indexes[key]['sources']:
            labels.append(name)
            colors_labels.append(colors[name])
            
    # –ø–æ—Å—á–∏—Ç–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã –≤—Å–µ—Ö –ø–æ—Ç–æ–∫–æ–≤
    perc_values = percent_users(sources, targets, values)
    
    # –¥–æ–±–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –¥–ª—è howertext
    link_text = []
    for perc in perc_values:
        link_text.append(f"{perc}%")
    
    # –≤–æ–∑–≤—Ä–∞—Ç–∏–º —Å–ª–æ–≤–∞—Ä—å —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏
    return {'sources': sources, 
            'targets': targets, 
            'values': values, 
            'labels': labels, 
            'colors_labels': colors_labels, 
            'link_color': link_color, 
            'link_text': link_text}
  

# —Å–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å
data_for_plot = lists_for_plot()


# In[39]:


def plot_senkey_diagram(data_dict=data_for_plot):    
    
    """
    –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –¥–∏–∞–≥—Ä–∞–º–º—ã –°–µ–Ω–∫–µ–π 
    
    Args:
        data_dict (dict): —Å–ª–æ–≤–∞—Ä—å —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è.
        
    Returns:
        plotly.graph_objs._figure.Figure: –æ–±—ä–µ–∫—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
    """
    
    fig = go.Figure(data=[go.Sankey(
        domain = dict(
          x =  [0,1],
          y =  [0,1]
        ),
        orientation = "h",
        valueformat = ".0f",
        
        node = dict(
          pad = 50,
          thickness = 15,
          line = dict(color = "black", width = 0.1),
          label = data_dict['labels'],
          color = data_dict['colors_labels']
        ),
        link = dict(
          source = data_dict['sources'],
          target = data_dict['targets'],
          value = data_dict['values'],
          label = data_dict['link_text'],
          color = data_dict['link_color']
      ))])
    fig.update_layout(title_text="Sankey Diagram", font_size=10, width=1000, height=500)

   


    
    # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ä–µ–∫—Ç –¥–∏–∞–≥—Ä–∞–º–º—ã
    return fig
  

# —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∏–∞–≥—Ä–∞–º–º—É –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
senkey_diagram = plot_senkey_diagram()


# In[40]:


senkey_diagram.show()


# <div id="div_id4" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ4](#1)
# 
# –î–∏–∞–≥—Ä–∞–º–º–∞ –°–∞–Ω–∫–µ—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –Ω–æ —Ç–∞–∫–æ–π –º–∞—Å—à—Ç–∞–± –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–µ–Ω. –£–º–µ–Ω—å—à–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–æ —Ä–∞–∑–º–µ—Ä–æ–≤ —Ç–µ—Ç—Ä–∞–¥–∫–∏.
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –ü–æ–º–µ–Ω—è–ª–∞ —Ä–∞–∑–º–µ—Ä –¥–∏–∞–≥—Ä–∞–º–º—ã.
# 
# </div>

# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v2] : </b>
# 
# üëç
# 
# </div>

# 1. –í–∏–¥–∏–º —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è 4 —à–∞–≥–∞–º–∏ –º–∞–∫—Å–∏–º—É–º
# 2. –°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–µ—Ä–≤—ã–µ —à–∞–≥–∏ tips_show, map, search
# 3. –ß—Ç–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º tips_show, photos_show, search –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è contact_show –¥–æ—Ö–æ–¥—è—Ç –∑–∞ 1 —à–∞–≥

# ### –°—Ç—Ä–æ–∏–º –≤–æ—Ä–æ–Ω–∫–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

# #### –í–æ—Ä–æ–Ω–∫–∞ map - contacts_show

# <div id="div_id5" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ5](#1)
# 
# –ù–µ —É–≤–∏–¥–µ–ª —ç—Ç–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ –°–∞–Ω–∫–µ—è. –¢–µ–±–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–¥–µ–ª–∏—Ç—å 3-4 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ —Ü–µ–ª–µ–≤–æ–º—É –¥–µ–π—Å—Ç–≤–∏—é
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –ü–æ–º–µ–Ω—è–ª–∞ c—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞ map –∏ contacts_show
# 
# </div>

# In[41]:


map_data=  data_clean.query('event_name == "map" ')
map_data_line=map_data.groupby('event_name')['user_id'].nunique().reset_index()
map_data_line=map_data_line[map_data_line['event_name']=='map']
map_data_line


# In[42]:



map_data_users=map_data.query('event_name =="map"')['user_id'].unique().tolist()


# In[43]:



contacts_map= data_clean.query('user_id == @map_data_users and event_name == "contacts_show" ')

contacts_map_line=contacts_map.groupby('event_name')['user_id'].nunique().reset_index()
contacts_map_line=contacts_map_line[contacts_map_line['event_name']=='contacts_show']


# In[44]:



comb_data_user=map_data_line.append(contacts_map_line)
comb_data_user


# In[45]:


contacts_map_count = comb_data_user['user_id'].to_list()
contacts_map_name  = comb_data_user['event_name'].to_list()


fig = go.Figure()
fig.add_trace(go.Funnel(
    y =contacts_map_name,
    x = contacts_map_count,
    textposition = "auto",
    textinfo = "value+percent initial+percent previous"

))
fig.update_layout(title='–í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π map contacts_show')
fig.show()


# <div id="div_id6" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ6](#1)
# 
# –ö–æ–Ω–≤–µ—Ä—Å–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞ –Ω–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–±—ã—Ç–∏–π
#     
# ---
#     
# ![image.png](attachment:image.png)
#     
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –ü–µ—Ä–µ—Å—á–∏—Ç–∞–ª–∞ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.
# 
# </div>

# <div id="div_id11" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ [v2] : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ11](#2)
# 
# 981 - —ç—Ç–æ –æ–±—â–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –ø–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—É. –¢–µ–±–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ —Å–∫–æ–ª—å–∫–æ –∏–∑ 1456 (–ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —ç—Ç–∞–ø–∞) –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã.
#     
# ![image.png](attachment:image.png)
#     
# –£ —Ç–µ–±—è –≤ –∫–∞–∂–¥–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ 981 - —Ç–∞–∫–æ–≥–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏.
#     
# ---
#     
# –ü–æ–¥–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π –∑–¥–µ—Å—å –∏ –¥–∞–ª–µ–µ.
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –ü–µ—Ä–µ—Å—á–∏—Ç–∞–ª–∞ –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ—è–º –∏–∑ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
# 
# </div>

# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v3] : </b>
# 
# üëç
# 
# </div>

# –í–∏–¥–∏–º —á—Ç–æ –ø–æ—á—Ç–∏ 20% –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø–æ—Å–ª–µ –æ—Å–º–æ—Ç—Ä–∞ –∫–∞—Ä—Ç—ã. –ì–æ–≤–æ—Ä–∏—Ç –æ —É–º–µ—Ä–µ–Ω–Ω–æ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ –∫–∞—Ä—Ç—ã

# #### –°—Ç—Ä–æ–∏–º –≤–æ—Ä–æ–Ω–∫—É search photos_show contacts_show

# –°—Ç—Ä–æ–∏–º —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ –µ–º—É –Ω—É–∂–Ω–æ –∏ –∏—â–µ—Ç —á–µ—Ä–µ–∑ –ø–æ–∏—Å–∫. search photos_show contacts_show

# In[46]:


search_data=  data_clean.query('event_name == "search" ')
search_data_line=search_data.groupby('event_name')['user_id'].nunique().reset_index()
search_data_line=search_data_line[search_data_line['event_name']=='search']


search_data_users=search_data.query('event_name =="search"')['user_id'].unique().tolist()

search_show= data_clean.query('user_id == @search_data_users and event_name == "photos_show" ')


search_show_line=search_show.groupby('event_name')['user_id'].nunique().reset_index()
search_show_line_1=search_show_line[search_show_line['event_name']=='photos_show']

comb_data_user=search_data_line.append(search_show_line)


search_show_users=search_show['user_id'].unique().tolist()




search_show_contacts= data_clean.query('user_id == @search_show_users and event_name == "contacts_show" ')


search_show_contacts_line=search_show_contacts.groupby('event_name')['user_id'].nunique().reset_index()
search_show_contacts_line=search_show_contacts_line[search_show_contacts_line['event_name']=='contacts_show']

comb_data_user=comb_data_user.append(search_show_contacts_line)

search_show_contacts_count = comb_data_user['user_id'].to_list()
search_show_contacts_name  = comb_data_user['event_name'].to_list()


fig = go.Figure()
fig.add_trace(go.Funnel(
    y =search_show_contacts_name ,
    x = search_show_contacts_count,
    textposition = "auto",
    textinfo = "value+percent initial+percent previous"

))
fig.update_layout(title='–í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π map contacts_show')
fig.show()


# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å search- photos_show –ø–æ—á—Ç–∏ 39%, –∏ 12% –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.   
# –¢–æ –µ—Å—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –¶–° –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—à–µ–ª –≤ –ø—Ä–∏—à–µ–ª –∑–Ω–∞—è —á—Ç–æ –µ–º—É –Ω–∞–¥–æ, –ø–æ–∏—Å–∫ –∏ –ø–æ–∫–∞–∑ —Ñ–æ—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ.

# #### –í–æ—Ä–æ–Ω–∫–∞ tips_show-contacts_show-tips_click

# –†–∞–∑–±–µ—Ä–µ–º –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ–±—ä—è–≤–ª–µ–Ω–∏–π, –ø–æ—Å—Ç—Ä–æ–∏–º –∫–∞–∫ —á–∞—Å—Ç–æ –ª—é–¥–∏ –Ω–∞–∂–∏–º–∞—é—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏ –∫–∞–∫ —á–∞—Å—Ç–æ –ø–æ—Ç–æ–º —Å–º–æ—Ç—Ä–∏—Ç contacts_show

# In[ ]:





# In[47]:


#1—Ä—è–¥ –∏ 2—Ä—è–¥
contacts_photo=  data.query('event_name == "tips_show" or event_name == "contacts_show" or event_name == "tips_click" ')
contacts_photo_count = contacts_photo.groupby('event_name')['user_id'].nunique().sort_values(
    ascending=False).reset_index()['user_id'].to_list()
contacts_photo_name = contacts_photo.groupby('event_name')['user_id'].nunique().sort_values(
    ascending=False).reset_index()['event_name'].to_list()


tips_show_data=  data_clean.query('event_name == "tips_show" ')
tips_show_line=tips_show_data.groupby('event_name')['user_id'].nunique().reset_index()
tips_show_line=tips_show_line[tips_show_line['event_name']=='tips_show']


tips_show_users=tips_show_data.query('event_name =="tips_show"')['user_id'].unique().tolist()

tips_show_contacts= data_clean.query('user_id == @tips_show_users and event_name == "contacts_show" ')


tips_show_contacts_line=tips_show_contacts.groupby('event_name')['user_id'].nunique().reset_index()
tips_show_contacts_line=tips_show_contacts_line[tips_show_contacts_line['event_name']=='contacts_show']

comb_data_user=tips_show_line.append(tips_show_contacts_line)

#3—Ä—è–¥

tips_show_contacts_users=tips_show_contacts['user_id'].unique().tolist()
tips_show_contacts_click= data_clean.query('user_id == @tips_show_contacts_users and event_name == "tips_click" ')


tips_show_contacts_click_line=tips_show_contacts_click.groupby('event_name')['user_id'].nunique().reset_index()


comb_data_user=comb_data_user.append(tips_show_contacts_click_line)

tips_show_contacts_click_count = comb_data_user['user_id'].to_list()
tips_show_contacts_click_name  = comb_data_user['event_name'].to_list()



fig = go.Figure()
fig.add_trace(go.Funnel(
    y = tips_show_contacts_click_name,
    x = tips_show_contacts_click_count,
    textposition = "auto",
    textinfo = "value+percent initial+percent previous"
))
fig.update_layout(title='–í–æ—Ä–æ–Ω–∫–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ tips_show-contacts_show-tips_click')
fig.show()


# –í–∏–¥–∏–º —á—Ç–æ –ª–∏—à—å 3 –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è, —á—Ç–æ –¥–∞–∂–µ –º–µ–Ω—å—à–µ —á–µ–º –¶–° –Ω–∞ 18%  
# –í–æ–∑–º–æ–∂–Ω–æ –Ω–µ–æ–±—Ö–¥–∏–º–æ –∏–∑—É—á–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–±–æ—Ä–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

# –û–±—à–∏–π –≤—ã–≤–æ–¥ –ø–æ —à–∞–≥—É  
#   - –ü–æ—Å—Ç—Ä–æ–∏–ª–∏ –î–∏–∞–≥—Ä–∞–º–º—É —Å–∞–Ω–∫–µ—è –∏ —É–≤–∏–¥–µ–ª–∏ —Å–ª–µ–¥—É—é—â–µ–µ:
#     1. –í–∏–¥–∏–º —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è 4 —à–∞–≥–∞–º–∏ –º–∞–∫—Å–∏–º—É–º
#     2. –°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–µ—Ä–≤—ã–µ —à–∞–≥–∏ tips_show, map, search
#     3. –ß—Ç–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º tips_show, photos_show, search –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è contact_show –¥–æ—Ö–æ–¥—è—Ç –∑–∞ 1 —à–∞–≥
# - –°—Ç—Ä–æ–∏–º –≤–æ—Ä–æ–Ω–∫—É –∏–∑ —Ç—Ä–µ—Ö —Å–∞–º—ã—Ö –ø–µ—Ä–≤—ã—Ö —à–∞–≥–æ–≤ —Å –¶–µ–ª–µ–≤—ã–º —Å–æ–±—ã—Ç–∏–µ–º —Å tips_show search  map contacts_show
#     1. –í–∏–¥–∏–º —á—Ç–æ –ø–æ—á—Ç–∏ 20% –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø–æ—Å–ª–µ –æ—Å–º–æ—Ç—Ä–∞ –∫–∞—Ä—Ç—ã. –ì–æ–≤–æ—Ä–∏—Ç –æ —É–º–µ—Ä–µ–Ω–Ω–æ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ –∫–∞—Ä—Ç—ã
# - –°—Ç—Ä–æ–∏–º —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ –µ–º—É –Ω—É–∂–Ω–æ –∏ –∏—â–µ—Ç —á–µ—Ä–µ–∑ –ø–æ–∏—Å–∫ search photos_show contacts_show
#     1.–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å search- photos_show –ø–æ—á—Ç–∏ 39%, –∏ 12% –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.   –¢–æ –µ—Å—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –¶–° –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—à–µ–ª –≤ –ø—Ä–∏—à–µ–ª –∑–Ω–∞—è —á—Ç–æ –µ–º—É –Ω–∞–¥–æ, –ø–æ–∏—Å–∫ –∏ –ø–æ–∫–∞–∑ —Ñ–æ—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ.
# -  –í–æ—Ä–æ–Ω–∫–∞ tips_show-contacts_show-tips_click –†–∞–∑–±–µ—Ä–µ–º –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ–±—ä—è–≤–ª–µ–Ω–∏–π, –ø–æ—Å—Ç—Ä–æ–∏–º –∫–∞–∫ —á–∞—Å—Ç–æ –ª—é–¥–∏ –Ω–∞–∂–∏–º–∞—é—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏ –∫–∞–∫ —á–∞—Å—Ç–æ –ø–æ—Ç–æ–º —Å–º–æ—Ç—Ä–∏—Ç contacts_show
#     1. –í–∏–¥–∏–º —á—Ç–æ –ª–∏—à—å 3 –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è, —á—Ç–æ –¥–∞–∂–µ –º–µ–Ω—å—à–µ —á–µ–º –¶–° –Ω–∞ 18%  
# –í–æ–∑–º–æ–∂–Ω–æ –Ω–µ–æ–±—Ö–¥–∏–º–æ –∏–∑—É—á–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–±–æ—Ä–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

# ## –ß–∞—Å—Ç–æ—Ç–∞ —Å–æ–±—ã—Ç–∏–π –≤ —Ä–∞–∑—Ä–µ–∑–µ –¥–≤—É—Ö –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. (—Å–º–æ—Ç—Ä–µ–ª–∏/–Ω–µ —Å–º–æ—Ç—Ä–µ–ª–∏ contacts_show)

# –†–∞—Å—Å—á–∏—Ç–∞–µ–º –∏ –ø–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –ø–æ —ç—Ç–∏–º –¥–≤—É–º –≥—Ä—É–ø–ø–∞–º

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏

# In[48]:


watched_users=data.query('event_name=="contacts_show"')
watched_users_list=watched_users['user_id'].unique().tolist()
print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏', watched_users['user_id'].nunique())


# <div id="div_id7" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ7](#1)
# 
# –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö 4293
#     
# ![image.png](attachment:image.png)
#     
# –û—Ç—É–∫–¥–∞ 4529?
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –í–º–µ—Å—Ç–æ nunique() –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ count(). 
# –ü–æ–¥–ø—Ä–∞–≤–∏–ª–∞.
#     
# </div>
# 

# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v2] : </b>
# 
# üëç
# 
# </div>

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏

# In[49]:


not_watched_users=list(set(data['user_id'].unique())-set(watched_users_list))
not_watched_users_list=data.query('user_id == @not_watched_users')['user_id'].unique().tolist()
print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏',data.query(
    'user_id == @not_watched_users')['user_id'].nunique())


# <div id="div_id13" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ [v3]: </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ13](#3)
# 
# –°–Ω–æ–≤–∞ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –∫–æ–¥. –ù–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–≤–æ–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–¥ —á–µ—Ä–µ–∑ Kernel -> Restart & Run All.
#     
# ![image.png](attachment:image.png)
# 
# 
# </div>

# In[50]:


watched_data=data.query('user_id==@watched_users_list')


# In[51]:


watched_data_list=watched_data['event_name'].value_counts().reset_index()

watched_data_list['%']=100*watched_data_list['event_name']/watched_data_list['event_name'].sum()
watched_data_list.columns=['event_name', 'watched_count','%watched']
watched_data_list


# In[52]:


not_watched_data=data.query('user_id==@not_watched_users_list')


# In[53]:


not_watched_data_list=not_watched_data['event_name'].value_counts().reset_index()
not_watched_data_list['%']=100*not_watched_data_list['event_name']/not_watched_data_list['event_name'].sum()
not_watched_data_list.columns=['event_name', 'not_watched_count','%not_watched']
not_watched_data_list


# In[54]:


data_comb=watched_data_list.merge(not_watched_data_list, on='event_name', how='left')
data_comb.fillna(0)


# <div id="div_id14" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ [v4]: </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ14](#4)
#     
# ![image.png](attachment:image.png)
#     
# –ü–æ—á–µ–º—É —Ç—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—à—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ Kernel -> Restart & Run All. –ü–æ–¥–æ–±–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è. –£ —Ç–µ–±—è —Ç—Ä–µ—Ç—å—é –∏—Ç–µ—Ä–∞—Ü–∏—é —Ä–∞–±–æ—Ç–∞ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—Å–µ —è—á–µ–π–∫–∏
# 
# 
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –î–æ–±—Ä–æ–µ —É—Ç—Ä–æ! –Ø –æ–±—ã—á–Ω–æ –ø—Ä–æ–µ–≤—Ä–∏–ª–∞ –∫–æ–¥ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É validate. –ë—É–¥—É –∏–º–µ—Ç—å –≤–≤–∏–¥—É, —á—Ç–æ —á–µ—Ä–µ–∑ Kernel –ø—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ.
#     
# </div>

# <div id="div_id15" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ [v5] : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ15](#5)
# 
# –î–∞–≤–∞–π –µ—â–µ —Ä–∞–∑. 
#     
# –¢–µ–±–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ `watched` –∏ `not_watched` —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–æ–ª—é —Å–æ–±—ã—Ç–∏–π.
#     
# –ù–∞–ø—Ä–∏–º–µ—Ä –≤ `watched` —Å–æ–±—ã—Ç–∏–µ `photos_show` –≤—Å—Ç—Ä–µ—á–∞–ª–æ—Å—å 3828. –î–æ–ª—è —ç—Ç–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –±—É–¥–µ—Ç 
#     
#     3828 / –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –≤ –≥—Ä—É–ø–ø–µ watched. 
#     
# –ò —Ç–∞–∫ –ø–æ –∫–∞–∂–¥–æ–º—É —Å–æ–±—ã—Ç–∏—é.
#     
# –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –∏ –≥—Ä—É–ø–ø–µ `not_watched`. –î–∞–ª–µ–µ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è –ø–æ–ª—É—á–∏–≤—à–∏–µ—Å—è –¥–æ–ª–∏ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏. –ù–∞–ø—Ä–∏–º–µ—Ä –≤ –ø–µ—Ä–≤–æ–π –≥—Ä—É–ø–ø–µ –¥–æ–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–æ—Ç–æ 20% (—Å –ø–æ—Ç–æ–ª–∫–∞), –∞ –≤–æ –≤—Ç–æ—Ä–æ–π –≥—Ä—É–ø–ø–µ –¥–æ–ø—É—Å—Ç–∏–º 10% - –¥–µ–ª–∞–µ—à—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤—ã–≤–æ–¥.
# 
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞2 : </b>
# 
# –î–æ–±—Ä–æ–µ –¥–µ–Ω—å! –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä–∞–∑—ä—è—Å–Ω–µ–Ω–∏–µ!
#     
# </div>

# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v6] : </b>
# 
# –¢–µ–ø–µ—Ä—å —Ä–∞—Å—á–µ—Ç –≤–µ—Ä–Ω—ã–π
# 
# </div>

# <div id="div_id12" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ [v2] : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ12](#2)
# 
# –Ø –Ω–µ –≤–∏–∂—É –¥–æ–ª–µ–π –∏–ª–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤. –¢—ã –≤—ã–≤–æ–¥–∏—à—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ.
#     
# –¢–µ–±–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–æ–ª–∏ —Å–æ–±—ã—Ç–∏–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ, —Å—Ä–∞–≤–Ω–∏—Ç—å —ç—Ç–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ –∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥
# 
# 
# </div>

# <div id="div_id8" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ8](#1)
# 
# 
# –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è - —ç—Ç–æ –¥–æ–ª—è (–ø—Ä–æ—Ü–µ–Ω—Ç) –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–±—ã—Ç–∏–π –≤ –≥—Ä—É–ø–ø–µ.
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –°–¥–µ–ª–∞–ª–∞ –ø–µ—Ä–µ—Ä–∞—Å—á–µ—Ç –∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∞ —Ç–∞–±–ª–∏—Ü—É
# 
# </div>

# –ß–∞—Å—Ç–æ—Ç–∞ —Å–æ–±—ã—Ç–∏–π –≤ —Ä–∞–∑—Ä–µ–∑–µ –¥–≤—É—Ö –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. (—Å–º–æ—Ç—Ä–µ–ª–∏/–Ω–µ —Å–º–æ—Ç—Ä–µ–ª–∏ contacts_show)¬∂
# –†–∞—Å—Å—á–∏—Ç–∞–µ–º –∏ –ø–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –ø–æ —ç—Ç–∏–º –¥–≤—É–º –≥—Ä—É–ø–ø–∞–º
# 
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ 981
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ 3312  
# 
# –¢–æ–ª—å–∫–æ –¥–æ–ª—è  watched –¥–µ–π—Å—Ç–≤–∏—è photo_show –ø—Ä–µ–≤—ã—à–∞–µ—Ç –¥–æ–ª—é –æ—Ç not_watched —Ç–æ–≥–æ –∂–µ –¥–µ–π—Å—Ç–≤–∏—è   
# –î–æ–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –≤—ã—à–µ –≤ –≥—Ä—É–ø–ø–µ –Ω–µ–ø–æ—Å–º–æ—Ç—Ä–µ–≤—à–∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç—ã, —á–µ–º –≤ –≥—Ä—É–ø–ø–µ —Å–º–æ—Ç—Ä–µ–≤—à–∏—Ö

# ## –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

# ### a. –û–¥–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–≤–µ—Ä—à–∞—é—Ç –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click , –¥—Ä—É–≥–∏–µ ‚Äî—Ç–æ–ª—å–∫–æ tips_show . –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—É: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è —É —ç—Ç–∏—Ö –¥–≤—É—Ö –≥—Ä—É–ø–ø.
# 

# –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ –ø–æ—Å–º–æ—Ç—Ä–µ–≤—à–∏—Ö tips_show –∏ tips_click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏—é

# 1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ tips_show –∏ tips_click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# In[55]:


tips_users = data.query('event_name =="tips_show"')['user_id'].unique().tolist()
tips_click_users = data.query('event_name =="tips_click" and user_id==@tips_users'
                             )['user_id'].unique().tolist()

tips_click_count = data.query('user_id==@tips_click_users')[['user_id', 'event_name']]

tips_click_count


# In[56]:


tips_click_count_len=tips_click_count['user_id'].nunique()
print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ tips_show –∏ tips_click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ', tips_click_count_len)


# In[57]:


tips_click_count_goal_event=tips_click_count[
    tips_click_count['event_name']=="contacts_show"]['user_id'].nunique()

print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ü–µ–ª–µ–≤—ã–º —Å–æ–±—ã—Ç–∏–µ–º –∏ tips_show+click:', tips_click_count_goal_event)


# In[58]:


tips_click_conv = tips_click_count_goal_event/tips_click_count_len
print(f'–ö–æ–Ω–≤–µ—Ä—Å–∏—è tips_show+click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = {round(tips_click_conv*100, 2)}%')


# 2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ç–æ–ª—å–∫–æ tips_show –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

# In[59]:


only_tips_users = list(set(tips_users) - set(tips_click_users))
only_tips_users_list=data.query('user_id==@only_tips_users')['user_id'].unique().tolist()
tips_click_count = data.query('user_id==@tips_click_users')[['user_id', 'event_name']]


# In[60]:


only_tips_users_data = data.query('user_id==@only_tips_users_list')[['user_id', 'event_name']]
only_tips_users_data 


# In[61]:


show_events_len=only_tips_users_data['user_id'].nunique()
print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ç–æ–ª—å–∫–æ tips_show –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', show_events_len)


# In[62]:


only_tips_users_list_goal_event=only_tips_users_data[
    only_tips_users_data['event_name']=="contacts_show"]['user_id'].nunique()

print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ç–æ–ª—å–∫–æ tips_show —Å —Ü–µ–ª–µ–≤—ã–º —Å–æ–±—ã—Ç–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', only_tips_users_list_goal_event)


# In[63]:


tips_show_conv=only_tips_users_list_goal_event/show_events_len
print(f'–ö–æ–Ω–≤–µ—Ä—Å–∏—è —Ç–æ–ª—å–∫–æ tips_show –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {round(tips_show_conv*100, 2)}%')


# <div id="div_id9" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ9](#1)
# 
# –ò –∑–¥–µ—Å—å –∫–æ–Ω–≤–µ—Ä—Å–∏—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –Ω–µ–≤–µ—Ä–Ω–æ. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —É –Ω–∞—Å –≤—Å–µ–≥–æ 4293, –∞ —Ç—ã —Å—á–∏—Ç–∞–µ—à—å –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–æ–±—ã—Ç–∏–π
# 
# </div>

# <div class="alert alert-warning" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úèÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —Ç–∏–º–ª–∏–¥–∞: </b>
# 
# –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞ –ø—Ä–µ–≤—ã—à–∞—é—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—É—é –¥–ª–∏–Ω—É –≤ 79 —Å–∏–º–≤–æ–ª–æ–≤.
# 
# –ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º PEP8, –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ä–∞–∑–¥–µ–ª—è—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞, –∏—Å–ø–æ–ª—å–∑—É—è –∫—Ä—É–≥–ª—ã–µ —Å–∫–æ–±–∫–∏.
# 
# –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª–∏—Ç —É–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞ –∏ —Å–æ–±–ª—é—Å—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã.
# 
# 
# </div>

# <div class="alert alert-info" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid " ><b> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞ : </b>
# 
# –ü–æ–¥–ø—Ä–∞–≤–∏–ª–∞, –ø–µ—Ä–µ–¥–µ–ª–∞–ª–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É 6 —Ä–∞–∑–¥–µ–ª–∞, —á—Ç–æ–±—ã –±—ã–ª–æ —É–¥–æ–±–Ω–µ–µ —á–∏—Ç–∞—Ç—å.
# 
# </div>

# <div id="div_id10" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚ÅâÔ∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ —Ç–∏–º–ª–∏–¥–∞ : </b>
# 
# <s>[‚¨Ü –û—à–∏–±–∫–∞ ‚Ññ10](#1)
# 
# 
# –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –ø—Ä–æ–±–ª–µ–º–æ–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ –∫–æ–¥–∞. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å - —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å—Ç–æ–∏—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å.
#     
# ![image.png](attachment:image.png)
# 
# –ù–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–≤–æ–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–¥ —á–µ—Ä–µ–∑ Kernel -> Restart & Run All.
# 
# –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π, –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏ —É–≤–µ–ª–∏—á–∏—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç.
# 
# </div>

# –ì–∏–ø–æ—Ç–µ–∑–∞

# 
#   
#     H0 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show  
#     H1 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show

# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v2] : </b>
# 
# –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ, —á—Ç–æ –Ω–µ –∑–∞–±—ã–≤–∞–µ—à—å –ø—Ä–æ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É –≥–∏–ø–æ—Ç–µ–∑. –≠—Ç–æ –≤–∞–∂–Ω—ã–π –ø—É–Ω–∫—Ç –≤ –ø–æ–¥–æ–±–Ω–æ–≥–æ —Ä–æ–¥–∞ –∑–∞–¥–∞—á–∞—Ö.
# 
# </div>

# –î–µ–ª–∞–µ–º z-test —Ç–∞–∫ –∫–∞–∫ –ø–µ—Ä–µ–¥ –Ω–∞–º–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–≤—É–º—è –∑–∞–≤–∏—Å–∏–º—ã–º–∏ –≥—Ä—É–ø–ø–∞–º–∏ —á–µ–π —Ä–∞–∑–º–µ—Ä –Ω–∞–º –∏–∑–≤—Å—Ç–µ–Ω

# In[64]:


def z_test(successes, trials, alpha): 
    
    # –ø—Ä–æ–ø–æ—Ä—Ü–∏—è —É—Å–ø–µ—Ö–æ–≤ –≤ –ø–µ—Ä–≤–æ–π –≥—Ä—É–ø–ø–µ:
    p1 = successes[0]/trials[0]

    # –ø—Ä–æ–ø–æ—Ä—Ü–∏—è —É—Å–ø–µ—Ö–æ–≤ –≤–æ –≤—Ç–æ—Ä–æ–π –≥—Ä—É–ø–ø–µ:
    p2 = successes[1]/trials[1]

    # –ø—Ä–æ–ø–æ—Ä—Ü–∏—è —É—Å–ø–µ—Ö–æ–≤ –≤ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ:
    p_combined = (successes[0] + successes[1]) / (trials[0] + trials[1])

    # —Ä–∞–∑–Ω–∏—Ü–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π –≤ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö
    difference = p1 - p2 

    # —Å—á–∏—Ç–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ —Å—Ç.–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
    z_value = difference / mth.sqrt(p_combined * (1 - p_combined) * (1/trials[0] + 1/trials[1]))

    # –∑–∞–¥–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (—Å—Ä–µ–¥–Ω–µ–µ 0, —Å—Ç.–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ 1)
    distr = st.norm(0, 1)

    p_value = (1 - distr.cdf(abs(z_value))) * 2

    print('p-–∑–Ω–∞—á–µ–Ω–∏–µ: ', p_value)

    if p_value < alpha:
        print('–û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞')
    else:
        print(
            '–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É, –Ω–µ—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏–π —Å—á–∏—Ç–∞—Ç—å –¥–æ–ª–∏ —Ä–∞–∑–Ω—ã–º–∏'
        ) 


# In[65]:


alpha = .05
successes = [tips_click_count_goal_event, only_tips_users_list_goal_event]
trials = [tips_click_count_len, show_events_len]
z_test(successes, trials, alpha) 


# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞ [v2] : </b>
# 
# –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–∏–ø–æ—Ç–µ–∑ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –≤–µ—Ä–Ω–æ + –≤—ã–≤–µ–¥–µ–Ω—ã –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø
# 
# </div>

# –ü–æ –∏—Ç–æ–≥–∞–º z-test –º—ã –æ—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É.  
# 
# –í—ã–≤–æ–¥: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show

# ### b. –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Ö—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π map –±–æ–ª—å—à–µ, —á–µ–º —É –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –µ–π.
# 
# 

# 1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# In[66]:


map_users = data.query('event_name =="map"')['user_id'].unique().tolist()


map_users_count = data.query('user_id==@map_users')[['user_id', 'event_name']]


# In[67]:


map_count=map_users_count['user_id'].nunique()
print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Å–æ–±—ã—Ç–∏–π —É map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ', map_count)


# In[68]:


goal_event_map=map_users_count[map_users_count['event_name']=="contacts_show"]['user_id'].nunique()
print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π =', goal_event_map)


# In[69]:


map_conv = goal_event_map / map_count
print(f'–ö–æ–Ω–≤–µ—Ä—Å–∏—è map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = {round(map_conv *100, 2)}%')


# 2. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# In[70]:


no_map_users = list(set(data['user_id'].unique().tolist()) - set(map_users))
no_map_user_counts = data.query('user_id==@no_map_users')[['user_id', 'event_name']]
goal_event_no_map=no_map_user_counts[
    no_map_user_counts['event_name']=="contacts_show"]['user_id'].nunique()
no_map_count=no_map_user_counts['user_id'].nunique()


# In[71]:


print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', no_map_count)


# In[72]:


print('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', goal_event_no_map)


# In[73]:


no_map_conv=goal_event_no_map/no_map_count
print(f'–ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = {round(no_map_conv*100, 2)}%')


# –ì–∏–ø–æ—Ç–µ–∑–∞ 

#  
#         H0 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏–µ map —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏  
#         H1 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è map –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏

# In[74]:


alpha = .05
successes = [goal_event_map, goal_event_no_map]
trials = [map_count, no_map_count]
z_test(successes, trials, alpha) 


# <div class="alert alert-success" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> ‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ç–∏–º–ª–∏–¥–∞  : </b>
# 
# –ò –∑–¥–µ—Å—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
# 
# </div>

# –ü–æ –∏—Ç–æ–≥–∞–º z-test –º—ã –æ—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É. –í—ã–≤–æ–¥: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è map –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏
# 

# –û–±—â–∏–π –≤—ã–≤–æ–¥ –ø–æ —à–∞–≥—É.   
# 
# –û–¥–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–≤–µ—Ä—à–∞—é—Ç –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click , –¥—Ä—É–≥–∏–µ ‚Äî—Ç–æ–ª—å–∫–æ tips_show . –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—É: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è —É —ç—Ç–∏—Ö –¥–≤—É—Ö –≥—Ä—É–ø–ø.  
# 
# –î–∞–Ω–Ω—ã–µ –ø–æ –≥—Ä—É–ø–ø–µ —Å tips_show –∏ tips_click
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Å–æ–±—ã—Ç–∏–π —É tips_show –∏ tips_click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 297
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É tips_show+click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 91  
# - –ö–æ–Ω–≤–µ—Ä—Å–∏—è tips_show+click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 6.83%
# 
# –î–∞–Ω–Ω—ã–µ –ø–æ –≥—Ä—É–ø–ø–µ —Ç–æ–ª—å–∫–æ tips_show
# 
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Å–æ–±—ã—Ç–∏–π —Ç–æ–ª—å–∫–æ tips_show –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 2504
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É —Ç–æ–ª—å–∫–æ tips_show –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 425
# - –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É —Ç–æ–ª—å–∫–æ tips_show –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 30.64%  
# 
# 
# –ì–∏–ø–æ—Ç–µ–∑–∞
# 
#     H0 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show  
#     H1 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show
#     –î–µ–ª–∞–µ–º z-test —Ç–∞–∫ –∫–∞–∫ –ø–µ—Ä–µ–¥ –Ω–∞–º–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–≤—É–º—è –∑–∞–≤–∏—Å–∏–º—ã–º–∏ –≥—Ä—É–ø–ø–∞–º–∏ —á–µ–π —Ä–∞–∑–º–µ—Ä –Ω–∞–º –∏–∑–≤—Å—Ç–µ–Ω
#     
#         p-–∑–Ω–∞—á–µ–Ω–∏–µ:  9.218316554537864e-09
#         –û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞
#         alpha = .05
#     –ü–æ –∏—Ç–æ–≥–∞–º z-test –º—ã –æ—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É. –í—ã–≤–æ–¥: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show
#     
# b. –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Ö—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π map –±–æ–ª—å—à–µ, —á–µ–º —É –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –µ–π.
# 
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Å–æ–±—ã—Ç–∏–π —É map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:  1456
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 289
# - –ö–æ–Ω–≤–µ—Ä—Å–∏—è map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 30.64%
# 
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Å–æ–±—ã—Ç–∏–π —É no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 2837
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 692
# - –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 24.39%
# 
# –ì–∏–ø–æ—Ç–µ–∑–∞
# 
#     H0 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏–µ map —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏  
#     H1 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è map –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏
# 
#         alpha = .05
#         z_test(successes, trials, alpha) 
#         p-–∑–Ω–∞—á–µ–Ω–∏–µ:  0.0007899493753891207
#     –ü–æ –∏—Ç–æ–≥–∞–º z-test –º—ã –æ—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É. –í—ã–≤–æ–¥: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è map –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏

# ## –û–±—â–∏–π –≤—ã–≤–æ–¥

# 1  –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:
# –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: –î–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ —Å–æ–±—ã—Ç–∏—è—Ö, —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –≤ –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ "–ù–µ–Ω—É–∂–Ω—ã–µ –≤–µ—â–∏". –í –Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–æ–¥–∞—é—Ç —Å–≤–æ–∏ –Ω–µ–Ω—É–∂–Ω—ã–µ –≤–µ—â–∏, —Ä–∞–∑–º–µ—â–∞—è –∏—Ö –Ω–∞ –¥–æ—Å–∫–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π.
# 
#   
#   –í –¥–∞—Ç–∞—Å–µ—Ç–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤–ø–µ—Ä–≤—ã–µ —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ø–æ—Å–ª–µ 7 –æ–∫—Ç—è–±—Ä—è 2019 –≥–æ–¥–∞.
# –ö–æ–ª–æ–Ω–∫–∏ –≤ /datasets/mobile_sources.csv :  
# 
# userId ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,  
# 
# source ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–∏–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.  
# 
# –ö–æ–ª–æ–Ω–∫–∏ –≤ /datasets/mobile_dataset.csv :  
# 
# event.time ‚Äî –≤—Ä–µ–º—è —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è,  
# 
# user.id ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,  
# 
# event.name ‚Äî –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
# 
# –í–∏–¥—ã –¥–µ–π—Å—Ç–≤–∏–π:  
# 
# advert_open ‚Äî –æ—Ç–∫—Ä—ã–ª –∫–∞—Ä—Ç–æ—á–∫–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,  
# 
# photos_show ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–ª —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏,  
# 
# tips_show ‚Äî —É–≤–∏–¥–µ–ª —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,  
# 
# tips_click ‚Äî –∫–ª–∏–∫–Ω—É–ª –ø–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–º—É –æ–±—ä—è–≤–ª–µ–Ω–∏—é,  
# 
# contacts_show –∏ show_contacts ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ–ª –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞,  
# 
# contacts_call ‚Äî –ø–æ–∑–≤–æ–Ω–∏–ª –ø–æ –Ω–æ–º–µ—Ä—É –∏–∑ –æ–±—ä—è–≤–ª–µ–Ω–∏—è,  
# 
# map ‚Äî –æ—Ç–∫—Ä—ã–ª –∫–∞—Ä—Ç—É –æ–±—ä—è–≤–ª–µ–Ω–∏–π, 
# 
# search_1 ‚Äî search_7 ‚Äî —Ä–∞–∑–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø–æ–∏—Å–∫–æ–º –ø–æ —Å–∞–π—Ç—É,  
# 
# favorites_add ‚Äî –¥–æ–±–∞–≤–∏–ª –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ.    
# 
# 
# 2 –®–∞–≥ –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö.
#   
# - –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –¥—É–±–ø–ª–∏–∫–∞—Ç—ã. –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞—à–ª–∏  
# - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª–∏ —Å—Ç–æ–ª–±—Ü—ã. 
# - –û–±—ä–µ–¥–∏–Ω–∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è contacts_show –∏ show_contacts
# - –û–±—ä–µ–¥–∏–Ω–∏–ª–∏  'search_1', 'search_2', 'search_3', 'search_4', 'search_5', 'search_6', 'search_7', –≤ –æ–¥–∏–Ω –ª–æ–≥ search
# - –ø—Ä–∏–≤–µ–ª–∏ —Å—Ç–æ–ª–±–µ—Ü —Å –¥–∞—Ç–∞–º–∏ –∫ –Ω—É–∂–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É  
# 
# 3 –®–∞–≥  –ò—Å—Å–ª–µ–¥—É–µ–º –¥–∞–Ω–Ω—ã–µ
# 
# - –ü–æ—Å—Ç—Ä–æ–∏–≤ —Ç–∞–±–ª–∏—Ü—É —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ª–æ–≥–æ–≤ –≤–∏–¥–∏–º, —á—Ç–æ —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π –ª–æ–≥ —ç—Ç–æ tips_show (—É–≤–∏–¥–µ–ª —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è), –∑–∞—Ç–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ –∏ search. –ê —Å–∞–º—ã–π –º–µ–Ω–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π –ª–æ–≥ —ç—Ç–æ tips_click and contact_call. –¶–µ–ª–µ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ —Ä–∞—Å–ø–æ–ª–æ–∂–∏–ª–æ—Å—å 5-–º —Å –∫–æ–Ω—Ü–∞ 
# - –ù–∞ —Ç–∞–±–ª–∏—Ü–µ —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –í–∏–¥–∏–º, —á—Ç–æ —Å–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–∫–æ–ª–æ —Ç–æ–ø15 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∏–ª–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ –æ—Ç 250 –¥–æ 500 –¥–µ–π—Å—Ç–≤–∏–π
# - –ü–æ—Å–º–æ—Ç—Ä–µ–≤ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é describe() –º—ã –≤–∏–ª–∏–º, —á—Ç–æ –≤ —Å—Ä–µ–¥–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–≤–µ—Ä–∞—à–∞–µ—Ç 17 –¥–µ–π—Å—Ç–≤–∏–π, –∞ –º–µ–¥–∏–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≥–æ–≤–æ—Ä–∏—Ç,—á—Ç–æ 9 –¥–µ–π—Å—Ç–≤–∏–π. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π —ç—Ç–æ 1
# - –ü—Ä–æ–≤–µ—Ä–∏–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º –≤–∏–¥–∏–º, —á—Ç–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–∏–ª—å–Ω–æ –º–µ–Ω—å—à–µ –±—ã–ª–∞ 12 –æ–∫—Ç—è–±—Ä—è –∏ —Ç–∞–∫–∂–µ —Å–∏–ª—å–Ω—ã –ø—Ä–æ–≤–∞–ª –≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞–±–ª—é–¥–∞–ª—Å—è –≤ 2 –Ω–æ—è–±—Ä—è. –ü—Ä–æ–≤–µ—Ä–∏–≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å, –≤–∏–¥–∏–º, —á—Ç–æ –æ–±–∞ –¥–Ω—è –±—ã–ª–∏ —Å—É–±–±–æ—Ç–∞–º–∏. –ù–∞–¥–æ –ø—Ä–µ–≤—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏. 
# -  –≤ –≥—Ä–∞—Ñ–∏–∫–µ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª—è–º –í–∏–¥–∏–º –∑–∞–º–µ—Ç–Ω–æ–µ –ø—Ä–æ—Å–µ–¥–∞–Ω–∏–µ –≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –Ω–µ–¥–µ–ª–∏, –≤ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å—É–±–±–æ—Ç—É.
# - –ü–æ–¥—Å—á–∏—Ç–∞–ª–∏ —Å–µ—Å—Å–∏–π, —Å–æ–∑–¥–∞–ª–∏ –∫–æ–ª–æ–Ω–∫—É session_id –∏ –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ –≤–æ—Ä–æ–Ω–∫—É —Å–æ–±—ã—Ç–∏–π.   
# –≤–∏–¥–∏–º, —á—Ç–æ —Å–∞–º—ã–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è tips_show, –∞ –Ω–∞–∏–º–µ–Ω–µ–µ favorites_add, tips_click, contacts_call.  
# –°—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–æ–π —Ä–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É tips_show –∏ tips_click, —á—Ç–æ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ª—é–¥–µ–π –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑—É—á–∏—Ç—å —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å
# 
# 4 –®–∞–≥. –ê–Ω–∞–ª–∏–∑ —Å–≤—è–∑–∏ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏
#  
#   - –ü–æ—Å—Ç—Ä–æ–∏–ª–∏ –î–∏–∞–≥—Ä–∞–º–º—É —Å–∞–Ω–∫–µ—è –∏ —É–≤–∏–¥–µ–ª–∏ —Å–ª–µ–¥—É—é—â–µ–µ:
#     1. –í–∏–¥–∏–º —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è 4 —à–∞–≥–∞–º–∏ –º–∞–∫—Å–∏–º—É–º
#     2. –°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–µ—Ä–≤—ã–µ —à–∞–≥–∏ tips_show, map, search
#     3. –ß—Ç–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º tips_show, photos_show, search –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è contact_show –¥–æ—Ö–æ–¥—è—Ç –∑–∞ 1 —à–∞–≥
# - –°—Ç—Ä–æ–∏–º –≤–æ—Ä–æ–Ω–∫—É –∏–∑ —Ç—Ä–µ—Ö —Å–∞–º—ã—Ö –ø–µ—Ä–≤—ã—Ö —à–∞–≥–æ–≤ —Å –¶–µ–ª–µ–≤—ã–º —Å–æ–±—ã—Ç–∏–µ–º —Å tips_show search  map contacts_show
#     1. –í–∏–¥–∏–º —á—Ç–æ –ø–æ—á—Ç–∏ 20% –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –ø–æ—Å–ª–µ –æ—Å–º–æ—Ç—Ä–∞ –∫–∞—Ä—Ç—ã. –ì–æ–≤–æ—Ä–∏—Ç –æ —É–º–µ—Ä–µ–Ω–Ω–æ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ –∫–∞—Ä—Ç—ã
# - –°—Ç—Ä–æ–∏–º —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ –µ–º—É –Ω—É–∂–Ω–æ –∏ –∏—â–µ—Ç —á–µ—Ä–µ–∑ –ø–æ–∏—Å–∫ search photos_show contacts_show
#     1.–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Å search- photos_show –ø–æ—á—Ç–∏ 39%, –∏ 12% –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.   –¢–æ –µ—Å—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –¶–° –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—à–µ–ª –≤ –ø—Ä–∏—à–µ–ª –∑–Ω–∞—è —á—Ç–æ –µ–º—É –Ω–∞–¥–æ, –ø–æ–∏—Å–∫ –∏ –ø–æ–∫–∞–∑ —Ñ–æ—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ.
# -  –í–æ—Ä–æ–Ω–∫–∞ tips_show-contacts_show-tips_click –†–∞–∑–±–µ—Ä–µ–º –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –æ–±—ä—è–≤–ª–µ–Ω–∏–π, –ø–æ—Å—Ç—Ä–æ–∏–º –∫–∞–∫ —á–∞—Å—Ç–æ –ª—é–¥–∏ –Ω–∞–∂–∏–º–∞—é—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏ –∫–∞–∫ —á–∞—Å—Ç–æ –ø–æ—Ç–æ–º —Å–º–æ—Ç—Ä–∏—Ç contacts_show
#     1. –í–∏–¥–∏–º —á—Ç–æ –ª–∏—à—å 3 –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è, —á—Ç–æ –¥–∞–∂–µ –º–µ–Ω—å—à–µ —á–µ–º –¶–° –Ω–∞ 18%  
# –í–æ–∑–º–æ–∂–Ω–æ –Ω–µ–æ–±—Ö–¥–∏–º–æ –∏–∑—É—á–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–±–æ—Ä–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
#       
#       
#   
# 5 –®–∞–≥. –ß–∞—Å—Ç–æ—Ç–∞ —Å–æ–±—ã—Ç–∏–π –≤ —Ä–∞–∑—Ä–µ–∑–µ –¥–≤—É—Ö –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. (—Å–º–æ—Ç—Ä–µ–ª–∏/–Ω–µ —Å–º–æ—Ç—Ä–µ–ª–∏ contacts_show)
#  –ß–∞—Å—Ç–æ—Ç–∞ —Å–æ–±—ã—Ç–∏–π –≤ —Ä–∞–∑—Ä–µ–∑–µ –¥–≤—É—Ö –≥—Ä—É–ø–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. (—Å–º–æ—Ç—Ä–µ–ª–∏/–Ω–µ —Å–º–æ—Ç—Ä–µ–ª–∏ contacts_show)¬∂
# –†–∞—Å—Å—á–∏—Ç–∞–µ–º –∏ –ø–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ –ø–æ —ç—Ç–∏–º –¥–≤—É–º –≥—Ä—É–ø–ø–∞–º
# 
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ 4529
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ 69668
# 
#   
#   –¢–æ–ª—å–∫–æ –¥–æ–ª—è  watched –¥–µ–π—Å—Ç–≤–∏—è photo_show –ø—Ä–µ–≤—ã—à–∞–µ—Ç –¥–æ–ª—é –æ—Ç not_watched —Ç–æ–≥–æ –∂–µ –¥–µ–π—Å—Ç–≤–∏—è 
#   –î–æ–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –≤—ã—à–µ –≤ –≥—Ä—É–ø–ø–µ –Ω–µ–ø–æ—Å–º–æ—Ç—Ä–µ–≤—à–∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç—ã, —á–µ–º –≤ –≥—Ä—É–ø–ø–µ —Å–º–æ—Ç—Ä–µ–≤—à–∏—Ö
#   
#   
# 6 –®–∞–≥. 
#  
# 
# –û–¥–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–≤–µ—Ä—à–∞—é—Ç –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click , –¥—Ä—É–≥–∏–µ ‚Äî—Ç–æ–ª—å–∫–æ tips_show . –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—É: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è —É —ç—Ç–∏—Ö –¥–≤—É—Ö –≥—Ä—É–ø–ø.  
# 
# –î–∞–Ω–Ω—ã–µ –ø–æ –≥—Ä—É–ø–ø–µ —Å tips_show –∏ tips_click
# 
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Å–æ–±—ã—Ç–∏–π —É tips_show –∏ tips_click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 297
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É tips_show+click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 91  
# - –ö–æ–Ω–≤–µ—Ä—Å–∏—è tips_show+click –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 30.64%
# 
# –î–∞–Ω–Ω—ã–µ –ø–æ –≥—Ä—É–ø–ø–µ —Ç–æ–ª—å–∫–æ tips_show
# 
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Å–æ–±—ã—Ç–∏–π —Ç–æ–ª—å–∫–æ tips_show –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 2504
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É —Ç–æ–ª—å–∫–æ tips_show –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 425
# - –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É —Ç–æ–ª—å–∫–æ tips_show –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 16.97%
# 
# 
# –ì–∏–ø–æ—Ç–µ–∑–∞
# 
#     H0 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show  
#     H1 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show
#     –î–µ–ª–∞–µ–º z-test —Ç–∞–∫ –∫–∞–∫ –ø–µ—Ä–µ–¥ –Ω–∞–º–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–≤—É–º—è –∑–∞–≤–∏—Å–∏–º—ã–º–∏ –≥—Ä—É–ø–ø–∞–º–∏ —á–µ–π —Ä–∞–∑–º–µ—Ä –Ω–∞–º –∏–∑–≤—Å—Ç–µ–Ω
#     
#         p-–∑–Ω–∞—á–µ–Ω–∏–µ:  9.218316554537864e-09
#         –û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞
#         alpha = .05
#     –ü–æ –∏—Ç–æ–≥–∞–º z-test –º—ã –æ—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É. –í—ã–≤–æ–¥: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è tips_show –∏ tips_click –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ —Ç–æ–ª—å–∫–æ tips_show
#     
# b. –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Ö—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π map –±–æ–ª—å—à–µ, —á–µ–º —É –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –µ–π.
# 
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Å–æ–±—ã—Ç–∏–π —É map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:  1456
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 289
# - –ö–æ–Ω–≤–µ—Ä—Å–∏—è map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 19.85%
#   
#   
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Å–æ–±—ã—Ç–∏–π —É no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 2837
# - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–≤–æ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —É no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 692
# - –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ —Ü–µ–ª–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è no_map –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π = 24.39%
# 
# –ì–∏–ø–æ—Ç–µ–∑–∞
# 
#     H0 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏–µ map —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏  
#     H1 - –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è map –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏
# 
#         alpha = .05
#         z_test(successes, trials, alpha) 
#         p-–∑–Ω–∞—á–µ–Ω–∏–µ:  0.0007899493753891207
#         –û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞
#     –ü–æ –∏—Ç–æ–≥–∞–º z-test –º—ã –æ—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É. –í—ã–≤–æ–¥: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è map –Ω–µ —Ä–∞–≤–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –≤ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏

# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞:  
# 
# - –ò–∑—É—á–∏—Ç—å –∫–∞–∫–∏–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞ –º–æ–≥–ª–∏ –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –ø–æ—Å–µ—â—è–µ–º–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏, –æ—Å–æ–±–µ–Ω–Ω–æ —Å—É–±–±–æ—Ç—É
# - –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–ª—É—á—à–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å tips_show –ø–æ tips_click, —Ç–∞–∫ –∫–∞–∫:   
#     a. –ö–æ–Ω–≤–µ—Ä—Å–∏—è —É –≥—Ä—É–ø–ø—ã –≥—Ä—É–ø–ø–µ —Ç–æ–ª—å–∫–æ tips_show –ø–æ—á—Ç–∏ –Ω–∞ 24 –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –±–æ–ª—å—à–µ, —á–µ–º tips_show+click (Z-—Ç–µ—Å—Ç –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ –¥–∞–Ω–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å—é)
#     b. —Ç–∞–∫–∂–µ –∫–æ–Ω–≤–µ—Ä—Å–∏—è tips_show –≤ tips_click —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ 11 –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
# 
# 

# <div id="div_id9" class="alert alert-danger" style="border-radius: 15px; box-shadow: 4px 4px 4px; border: 1px solid; position: relative; padding: 15px; padding-left: 80px;">
# <img src="https://lh3.googleusercontent.com/a/AAcHTtc31jlywy-FMYxLAouSSqNAmm5NsrBvivwRIASNt7wihI2ClYdpAbzWNqcigfcR04LfvopHwsJrJpnVr4UXDkCHtWk=s432-c-no" width="45" height="45" style="position: absolute; top: 15px; left: 15px; border-radius: 50%;">
# <b> –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï : </b>
# 
# 
# –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Ç—ã –≤–Ω–µ—Å—ë—à—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–º–µ—á–∞–Ω–∏–π, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∏ –∏ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä—É–π –∏—Ç–æ–≥–æ–≤–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ.
# 
# </div>
